<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="I CAN MAKE THIS WORK RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="I CAN MAKE THIS WORK Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-51754530-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="icon" href="/img/favicon/profile.jpg">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/favicon/apple-touch-icon.png"><title data-react-helmet="true">11 posts tagged with &quot;asp.net mvc&quot; | I CAN MAKE THIS WORK</title><meta data-react-helmet="true" property="og:title" content="11 posts tagged with &quot;asp.net mvc&quot; | I CAN MAKE THIS WORK"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" name="twitter:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" property="og:url" content="https://blog.johnnyreilly.com/tags/asp-net-mvc"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-react-helmet="true" name="robots" content="max-image-preview:large"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://blog.johnnyreilly.com/tags/asp-net-mvc"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/tags/asp-net-mvc" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/tags/asp-net-mvc" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ff16c2af.css">
<link rel="preload" href="/assets/js/runtime~main.9adf4245.js" as="script">
<link rel="preload" href="/assets/js/main.7a281289.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">I CAN MAKE THIS WORK</b></a><a class="navbar__item navbar__link" href="/about">About</a><a class="navbar__item navbar__link" href="/blog-archive">Blog Archive</a><a class="navbar__item navbar__link" href="/talks">Talks</a></div><div class="navbar__items navbar__items--right"><a href="https://polywork.johnnyreilly.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Polywork<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-tags-post-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/11/18/azure-standard-tests-with-bicep">Azure standard availability tests with Bicep</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/10/31/nswag-generated-c-sharp-client-property-name-clash">NSwag generated C# client: Open API property name clashes and decimal types rather than double</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/10/18/docusaurus-meta-tags-and-google-discover">Docusaurus, meta tags and Google Discover</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/10/15/structured-data-seo-and-react">Structured data, SEO and React</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/09/12/permissioning-azure-pipelines-bicep-role-assignments">Permissioning Azure Pipelines with Bicep and Azure RBAC Role Assignments</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>11 posts tagged with &quot;asp.net mvc&quot;</h1><a href="/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2015/05/11/ngvalidationfor-baby-steps">NgValidationFor Baby Steps</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2015-05-11T00:00:00.000Z" itemprop="datePublished">May 11, 2015</time> · <!-- -->4 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>I thought as I start the <a href="http://blog.icanmakethiswork.io/2015/04/tonight-ill-start-open-source-project.html" target="_blank" rel="noopener noreferrer">NgValidationFor project</a> I&#x27;d journal my progress. I&#x27;m writing this with someone particular in mind: me. Specifically, me in 2 years who will no doubt wonder why I made some of the choices I did. Everyone else, move along now - nothing to see. Unless the inner workings of someone else&#x27;s mind are interesting to you... In which case: welcome!</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="getting-up-and-running">Getting up and running<a aria-hidden="true" class="hash-link" href="#getting-up-and-running" title="Direct link to heading">​</a></h2><p>I&#x27;ve got a project on <a href="https://github.com/johnnyreilly/NgValidationFor" target="_blank" rel="noopener noreferrer">GitHub</a> and I&#x27;m starting to think about implementations. One thing that bit me on <a href="http://johnnyreilly.github.io/jQuery.Validation.Unobtrusive.Native/" target="_blank" rel="noopener noreferrer">jVUN</a> was being tied to a specific version of ASP.Net MVC. For each major release of ASP.Net MVC I needed separate builds / NuGet packages and the like. A pain. Particularly when it came to bug fixes for prior versions - the breaking changes with each version of MVC meant far more work was required when it came to shipping fixes for MVC 4 / MVC 3.</p><p>So with that in mind I&#x27;m going to try and limit my dependencies. I&#x27;m not saying I will never depend upon ASP.Net MVC - I may if I think it becomes useful to give the users a nicer API or if there&#x27;s another compelling reason. But to start with I&#x27;m just going to focus on the translation of data annotations to Angular validation directive attributes.</p><p>To that end I&#x27;m going to begin with just a class library and an associated test project. I&#x27;m going to try and minimise the dependencies that NgValidationFor has. At least initially I may even see if I can sensibly avoid depending on <code>System.Web</code> (mindful of the upcoming ASP.Net 5 changes). Let&#x27;s see.</p><p>A little time passes.......</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="so-what-have-we-got">So what have we got?<a aria-hidden="true" class="hash-link" href="#so-what-have-we-got" title="Direct link to heading">​</a></h2><p>My first efforts have resulted in the implementation of the <code>&lt;a href=&quot;https://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.requiredattribute(v=vs.110).aspx&quot;&gt;RequiredAttribute&lt;/a&gt;</code>. This is the <a href="https://github.com/johnnyreilly/NgValidationFor/tree/6cf862a7638d3ed933cd0e075a1807b1414847da" target="_blank" rel="noopener noreferrer">code right now</a>. It&#x27;s made up of:</p><ol><li>NgValidationFor.Core - the core part of the project which converts data annotations into AngularJS 1.x validation directive attributes.</li><li>NgValidationFor.Core.UnitTests - the unit tests for the core</li><li>NgValidationFor.Documentation - this is an ASP.Net MVC project which will become a documentation site for NgValidationFor. It also doubles as a way for me to try out NgValidationFor.</li><li>NgValidationFor.Documentation.UnitTests - unit tests for the documentation (there&#x27;s none yet as I&#x27;m still spiking - but when I&#x27;m a little clearer, they will be)</li></ol><p>How can it be used? Well fairly easily. Take this simple model:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">using System.ComponentModel.DataAnnotations;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">namespace NgValidationFor.Documentation.Models</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    public class RequiredDemoModel</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        [Required]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        public string RequiredField { get; set; }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>When used in an MVC View for which <code>RequiredDemoModel</code> is the Model, NgValiditionFor can be used thusly:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">@using NgValidationFor.Core @using NgValidationFor.Documentation.Models @model</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">RequiredDemoModel &lt;input type=&quot;text&quot; name=&quot;userName&quot; ng-model=&quot;user.name&quot;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">@Html.Raw(Model.GetAttributes(x =&gt; Model.RequiredField)) &gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Which results in this HTML:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">input</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">userName</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">ng-model</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">user.name</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">required</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">required</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Tada!!!! It works.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="so-what-now">So what now?<a aria-hidden="true" class="hash-link" href="#so-what-now" title="Direct link to heading">​</a></h2><p>Yes it works, but I&#x27;m not going to pretend it&#x27;s pretty. I don&#x27;t like having to wrap the usage of NgValidationFor with <code>Html.Raw(...)</code>. I&#x27;m having to do that because <code>GetAttributes</code> returns a <code>string</code>. This string is then HTML encoded by MVC. To avoid my quotation marks turning into <code>&amp;amp;quot;</code> I need to actually be exposing an <code>&lt;a href=&quot;https://msdn.microsoft.com/en-us/library/system.web.ihtmlstring(v=vs.110).aspx&quot;&gt;IHtmlString&lt;/a&gt;</code>. So I&#x27;m going to need to depend upon <code>System.Web</code>. That&#x27;s not so bad - at least I&#x27;m not tied to a specific MVC version.</p><p>I&#x27;m not too keen on the implementation I&#x27;ve come up with for NgValidationFor either. It&#x27;s a single static method at the minute which does everything. It breaks the <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle" target="_blank" rel="noopener noreferrer">Single Responsibility Priniciple</a> and the <a href="https://en.wikipedia.org/wiki/Open/closed_principle" target="_blank" rel="noopener noreferrer">Open/Closed Principle</a>. I need to take a look at that - I want people to be able to extend this and I need to think about a good and simple way to achieve that.</p><p>Finally, usage. <code>Model.GetAttributes(x =&amp;gt; Model.RequiredField)</code> feels wrong to me. I think I&#x27;m happy with having this used as an extension method but it needs to be clearer what&#x27;s happening. Perhaps <code>Model.NgValidationFor(x =&amp;gt; Model.RequiredField)</code> would be better. I need to try a few things out and come up with a nicer way to use NgValidationFor.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/angular-js">AngularJS</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/ng-validation-for">NgValidationFor</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about NgValidationFor Baby Steps" href="/2015/05/11/ngvalidationfor-baby-steps"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2015/05/05/a-tale-of-angular-html5mode-aspnet-mvc">A tale of Angular, html5mode, ASP.Net MVC and ASP.Net Web API</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2015-05-05T00:00:00.000Z" itemprop="datePublished">May 5, 2015</time> · <!-- -->3 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>So. You want to kick hash based routing to the kerb. You want <em>real</em> URLs. You&#x27;ve read the HTML5 mode section of the <a href="https://docs.angularjs.org/guide/$location" target="_blank" rel="noopener noreferrer">Angular $location docs</a> and you&#x27;re good to go. It&#x27;s just a matter of dropping <code>$locationProvider.html5Mode(true)</code> into your app initialisation right?</p><p>Wrong.</p><p>You want your URLs to be shareable. If, when you copy the URL out of your browser and send it someone else, they do not get taken to the same position in the application as you do then I&#x27;ve got news for you: THAT&#x27;S NOT REALLY A URL. And just using <code>$locationProvider.html5Mode(true)</code> has done nothing useful for you. You want to ensure that, if the URL entered in the browser does not relate to a specific server-side end-point, the self-same HTML root page is <em>always</em> served up. Then Angular can load the correct resources for the URL you have entered and get you to the required state.</p><p>There are tips to be found in Angular UI&#x27;s <a href="https://github.com/angular-ui/ui-router/wiki/Frequently-Asked-Questions#how-to-configure-your-server-to-work-with-html5mode" target="_blank" rel="noopener noreferrer">How to: Configure your server to work with html5Mode</a> doc. However they required a little extra fiddling to get my ASP.Net back end working quite as I wanted. To save you pain, here are my cultural learnings.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="aspnet-mvc">ASP.Net MVC<a aria-hidden="true" class="hash-link" href="#aspnet-mvc" title="Direct link to heading">​</a></h2><p>I had an ASP.Net MVC app which I wanted to use <code>html5mode</code> with. To do this is simply a matter of tweaking your <code>RouteConfig.cs</code> like so:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">public class RouteConfig</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        public static void RegisterRoutes(RouteCollection routes)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            routes.IgnoreRoute(&quot;{resource}.axd/{*pathInfo}&quot;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            // Here go the routes that you still want to be able to hit</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            routes.MapRoute(</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                name: &quot;IAmARouteThatYouStillWantToHit&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                url: &quot;ThatsWhyIAmRegisteredFirst&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                defaults: new { controller = &quot;Hittable&quot;, action = &quot;Index&quot; }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            // Everything else will hit Home/Index which serves up the root angular app page</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            routes.MapRoute(</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                name: &quot;Default&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                url: &quot;{*anything}&quot;, // THIS IS THE MAGIC!!!!</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                defaults: new { controller = &quot;Home&quot;, action = &quot;Index&quot; }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>With this in place my existing routes work just as I would hope. Any route that doesn&#x27;t fit that registered can be assumed to be <code>html5mode</code> related and will serve up the root angular app page as I&#x27;d hope.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="aspnet-web-api">ASP.Net Web API<a aria-hidden="true" class="hash-link" href="#aspnet-web-api" title="Direct link to heading">​</a></h2><p>Later I realised that the app in question was mostly static content. Certainly the root angular app page was and so it seemed wasteful to require an ASP.Net MVC controller to serve up that static content. So I stripped out MVC from the app entirely, choosing to serve raw HTML instead. For the dynamic parts I switched to using Web API. This was &quot;hittable&quot; as long as I had my <code>WebApiConfig.cs</code> and my <code>system.webServer</code> section in my <code>web.config</code> lined up correctly, viz:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">public static class WebApiConfig</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        public static void Register(HttpConfiguration config)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            // Web API routes</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            config.MapHttpAttributeRoutes();</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            config.Routes.MapHttpRoute(</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                name: &quot;DefaultApi&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                routeTemplate: &quot;api/{controller}/{id}&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                defaults: new { id = RouteParameter.Optional }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            // other stuff</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><pre tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">configuration</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">system.webServer</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">defaultDocument</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">files</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">clear</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">add</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">value</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">build/index.html</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">&lt;!-- This is the root document for the Angular app --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">files</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">defaultDocument</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">rewrite</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">rules</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">rule</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">Main Rule</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">stopProcessing</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">true</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">match</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">url</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">.*</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">conditions</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">logicalGrouping</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">MatchAll</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                        </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">&lt;!-- Allows &quot;api/&quot; prefixed URLs to still hit Web API controllers</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">                             as defined in WebApiConfig --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">add</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">input</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">{REQUEST_URI}</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">pattern</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">api/</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">ignoreCase</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">true</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">negate</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">true</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                        </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">&lt;!-- Static files and directories can be served so partials etc can be loaded --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">add</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">input</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">{REQUEST_FILENAME}</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">matchType</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">IsFile</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">negate</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">true</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">add</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">input</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">{REQUEST_FILENAME}</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">matchType</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">IsDirectory</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">negate</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">true</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">conditions</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">action</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">Rewrite</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">url</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">rule</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">rules</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">rewrite</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">system.webServer</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">configuration</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>With this in place I can happily hit &quot;api&quot; prefixed URLs and still land on my Web API controllers whilst other URLs will serve up the root angular app page. Lovely.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net">asp.net</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/html-5-mode">html5mode</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/angular-js">AngularJS</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-web-api">ASP.Net Web API</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about A tale of Angular, html5mode, ASP.Net MVC and ASP.Net Web API" href="/2015/05/05/a-tale-of-angular-html5mode-aspnet-mvc"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2015/04/24/tonight-ill-start-open-source-project">Tonight I&#x27;ll Start an Open Source Project...</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2015-04-24T00:00:00.000Z" itemprop="datePublished">April 24, 2015</time> · <!-- -->6 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h3 class="anchor anchorWithStickyNavbar_31ik" id="further-posts-on-this-topic">Further posts on this topic<a aria-hidden="true" class="hash-link" href="#further-posts-on-this-topic" title="Direct link to heading">​</a></h3><ul><li><a href="https://blog.johnnyreilly.com/2015/05/ngvalidationfor-baby-steps.html" target="_blank" rel="noopener noreferrer">NgValidationFor Baby Steps</a></li></ul><p>I&#x27;m excited. Are you? I&#x27;m babysitting for a friend, I&#x27;ve my laptop, time to kill and (crucially) an idea...</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="the-idea">The Idea<a aria-hidden="true" class="hash-link" href="#the-idea" title="Direct link to heading">​</a></h2><p>You&#x27;re likely aware of the various form element directives that AngularJS offers. For instance the <a href="https://docs.angularjs.org/api/ng/directive/input" target="_blank" rel="noopener noreferrer">input directive</a>:</p><blockquote><p>HTML input element control. When used together with ngModel, it provides data-binding, input state control, and <em>validation</em>.</p></blockquote><p>You&#x27;ll notice that I emphasised the word &quot;validation&quot; there. That&#x27;s important - that&#x27;s my idea. I&#x27;m using AngularJS to build SPA&#x27;s and for the server side I&#x27;m using ASP.Net MVC / Web API. Crucially, my templates are actually ASP.Net MVC Partial Views. That&#x27;s key.</p><p>When I send data back from my SPA back to the server it gets unmarshalled / deserialized into a C# class (view model) of some kind. When data goes the other way it&#x27;s flowing back from a JSON&#x27;d view model and being used by my Angular code.</p><p>Now historically if I was building a fairly vanilla MVC app then I&#x27;d be making use of all the <code>TextboxFor</code> extension methods etc to generate my input elements. For example, with a view model like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">using System.ComponentModel.DataAnnotations;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">namespace App.ViewModels</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"> public class RequiredModel</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"> {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  [Required]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  public string RequiredField{ get; set; }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>I&#x27;d have a view like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">@model App.ViewModels.RequiredModel @using (Html.BeginForm()) {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">row</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  @Html.LabelFor(x =&gt; x.TextBox, &quot;Something must be entered:&quot;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  @Html.TextBoxFor(x =&gt; x.TextBox, true)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And that would generate HTML like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">action</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/Demo/Required</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">method</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">post</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">row</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">for</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">TextBox</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Something must be entered:</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">input</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">data-msg-required</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">The TextBox field is required.</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">data-rule-required</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">true</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">TextBox</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">TextBox</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">value</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If you look at the HTML you&#x27;ll see that the <code>Required</code> data annotations have been propogated into the HTML in the HTML in the form of <code>data-rule-*</code> and <code>data-msg-*</code> attributes. The code above is built using my <a href="http://johnnyreilly.github.io/jQuery.Validation.Unobtrusive.Native/" target="_blank" rel="noopener noreferrer">jQuery.Validation.Unobtrusive.Native project</a> which in turn was inspired by / based upon the <a href="http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html" target="_blank" rel="noopener noreferrer">Unobtrusive Client Validation in ASP.NET MVC</a>. That&#x27;s right - I&#x27;ve done this before - or at least something quite like it.</p><p>There&#x27;s clearly a strong crossover between AngularJS&#x27;s input directive parameters and unobtrusive client validation. I&#x27;m planning to take the principles (and maybe some of the code) that I used on that project and see if I can&#x27;t make something useful with it here. <a href="https://blog.johnnyreilly.com/2014/08/angularjs-meet-aspnet-server-validation.html" target="_blank" rel="noopener noreferrer">Server side validation is jolly important</a> but I can probably save a few compute cycles on the server by making use of client side validation as well. If I&#x27;m right then I should able to come up with a mechanism that saves me from manually duplicating my server validation on the client.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="the-aim">The Aim<a aria-hidden="true" class="hash-link" href="#the-aim" title="Direct link to heading">​</a></h2><p>I want to be able to use HTML Helpers to propogate validation metadata from the server view models into angular form validation directive attributes. Quite a mouthful I know. What does that actually mean? Well I&#x27;ve got 2 ideas. Possibly I want to be able to code something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">@model App.ViewModels.RequiredModel @using (Html.BeginForm()) {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">row</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  @Html.LabelFor(x =&gt; x.TextBox, &quot;Something must be entered:&quot;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  @Html.NgTextBoxFor(x =&gt; x.TextBox)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And have HTML like this generated:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">action</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/Demo/Required</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">method</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">post</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">row</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">for</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">TextBox</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Something must be entered:</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">input</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">ng-required</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">true</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">TextBox</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">TextBox</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">      </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">value</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The reservation I have about this approach is that it rather takes you away from the HTML. Yes it works (and to your seasoned MVC-er it will feel quite natural in some ways) but it feels rather heavy handed. But I&#x27;d like what I&#x27;m building to be easy for users to plug into existing code without a ton of rework. So, the other idea I&#x27;m toying with is having HTML helpers that just return a string of attributes. So if I had an angular form that looked like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">ng-controller</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">ExampleController</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">row</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Something must be entered:</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">input</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">RequiredField</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">value</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>I could tweak it to push in the validation directive attributes like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">@model App.ViewModels.RequiredModel</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">ng-controller</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">ExampleController</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">row</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Something must be entered: &lt;input name=&quot;RequiredField&quot; type=&quot;text&quot;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        value=&quot;&quot; @Html.NgValidationFor(x =&gt; x.RequiredField) /&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And end up with HTML like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">ng-controller</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">ExampleController</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">row</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Something must be entered:</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">input</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">RequiredField</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">value</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">ng-required</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">true</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">form</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This is a simplified example of course - it&#x27;s likely that any number of validation directive attributes might be returned from <code>NgValidationFor</code>. And crucially if these attributes were changed on the server view model then the validation changes would automatically end up in the client HTML with this approach.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="the-approach">The Approach<a aria-hidden="true" class="hash-link" href="#the-approach" title="Direct link to heading">​</a></h2><p>At least to start off with I&#x27;m going to aim at creating the second of my approaches. I may come back and implement the first at some point but I think the second is a better place to start.</p><p>I&#x27;m kind of surprised no-one else has built this already actually - but I&#x27;m not aware of anything. I&#x27;ve had a little duckduckgo around and found no takers. The closest I&#x27;ve come is the excellent <a href="http://www.breezejs.com/sites/all/apidocs/classes/Validator.html" target="_blank" rel="noopener noreferrer">BreezeJS</a>. BreezeJS does way more than I want it to - I&#x27;m planning to restrict the scope of this project to simply turning data annotations on my ASP.Net MVC server models into <code>ng-*</code> directive attributes in HTML. That&#x27;s it.</p><p>So, general housekeeping.... I&#x27;m going to host this project on <a href="http://www.github.com" target="_blank" rel="noopener noreferrer">GitHub</a>, I&#x27;m going to have Continuous Integration with <a href="http://www.appveyor.com/" target="_blank" rel="noopener noreferrer">AppVeyor</a> and I&#x27;m planning to publish this via <a href="http://www.nuget.org/" target="_blank" rel="noopener noreferrer">NuGet</a> (when and if I&#x27;ve created something useful).</p><p>I just need a name and I&#x27;ll begin. What shall I call it? Some options:</p><ul><li>Angular ASP.Net MVC Extensions</li><li>angular-aspnet-mvc-extensions</li><li>Angular MVC Element Extensions</li><li>Angular Validation Html Helpers</li><li>NgValidationFor (the name of the HTML helper I made up)</li></ul><p>Hmmmm.... None of them is particularly lighting my fire. The first four are all a bit <a href="https://en.wikipedia.org/wiki/Ronseal" target="_blank" rel="noopener noreferrer">RonSeal</a> <!-- -->-<!-- --> which is fine.... Ug. The last one... It&#x27;s a bit more pithy. Okay - I&#x27;ll go with &quot;NgValidationFor&quot; at least for now. If something better occurs I can always change my mind.</p><p><a href="https://github.com/johnnyreilly/NgValidationFor" target="_blank" rel="noopener noreferrer">And we&#x27;re off!</a></p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/validation">validation</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/angular-js">AngularJS</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Tonight I&#x27;ll Start an Open Source Project..." href="/2015/04/24/tonight-ill-start-open-source-project"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2015/03/20/partialview-tostring">PartialView.ToString()</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2015-03-20T00:00:00.000Z" itemprop="datePublished">March 20, 2015</time> · <!-- -->4 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>In the name of <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" target="_blank" rel="noopener noreferrer">DRY</a> I found myself puzzling how one could take a <code>PartialViewResult</code> and render it as a <code>string</code>. Simple, right?</p><p>In fact, in my head this was already a solved problem. I mean I&#x27;ve written about this <a href="http://blog.icanmakethiswork.io/2012/07/rendering-partial-view-to-string.html" target="_blank" rel="noopener noreferrer">before</a> already! Except I haven&#x27;t. Not really - what I did back then was link to what someone else had written and say &quot;yay! well done chap - like he said!&quot;. It turns out that was a bad move. That blog appears to be gone and so I&#x27;m back to where I was. Ug. Lesson learned.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="what-are-we-trying-to-do">What are we trying to do?<a aria-hidden="true" class="hash-link" href="#what-are-we-trying-to-do" title="Direct link to heading">​</a></h2><p>So, for the second time of asking, here is how to take a <code>PartialViewResult</code> and turn it into a <code>string</code>. It&#x27;s an invaluable technique to deal with certain scenarios.</p><p>In my own case I have a toolbar in my application that is first pushed into the UI in my <code>_Layout.cshtml</code> by means of a trusty <code>@Html.Action(&quot;Toolbar&quot;)</code>. I wanted to be able to re-use the <code>PartialViewResult</code> returned by <code>Toolbar</code> on my controller inside a <code>JSON</code> payload. And despite the title of this post, <code>PartialView.ToString()</code><em>doesn&#x27;t</em> quite cut the mustard. Obvious really, if it did then why would I be writing this and you be reading this?</p><p>The solution is actually fairly simple. And, purely for swank, I&#x27;m going to offer it you 3 ways. Whatever&#x27;s your poison.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="inheritance-its-so-yesterday-darling">Inheritance (it&#x27;s so yesterday darling)<a aria-hidden="true" class="hash-link" href="#inheritance-its-so-yesterday-darling" title="Direct link to heading">​</a></h2><p>Yes there was a time when everything was inheritance based. You were rewarded handsomely for making sure that was the case. However, times have changed and (with good reason) people tend to <a href="https://en.wikipedia.org/wiki/Composition_over_inheritance" target="_blank" rel="noopener noreferrer">favour composition over inheritance</a>. So, perhaps just for the memories, let first offer you the inheritance based approach:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">protected string ConvertPartialViewToString(PartialViewResult partialView)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  using (var sw = new StringWriter())</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    partialView.View = ViewEngines.Engines</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      .FindPartialView(ControllerContext, partialView.ViewName).View;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    var vc = new ViewContext(</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      ControllerContext, partialView.View, partialView.ViewData, partialView.TempData, sw);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    partialView.View.Render(vc, sw);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    var partialViewString = sw.GetStringBuilder().ToString();</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return partialViewString;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The idea being that the above method is placed onto a base controller which your controllers subclass. Thus using this method inside one of the controllers is as simple as:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">var toolbarHtml = ConvertPartialViewToString(partialViewResult);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="extension-method-sexier-syntax">Extension method (sexier syntax)<a aria-hidden="true" class="hash-link" href="#extension-method-sexier-syntax" title="Direct link to heading">​</a></h2><p>So the next choice is implementing this as an extension method. Here&#x27;s my static class which adds <code>ConvertToString</code> onto <code>PartialViewResult</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">using System.IO;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">using System.Web.Mvc;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">namespace My.Utilities.Extensions</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  public static class PartialViewResultExtensions</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    public static string ConvertToString(this PartialViewResult partialView,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                                              ControllerContext controllerContext)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      using (var sw = new StringWriter())</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        partialView.View = ViewEngines.Engines</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          .FindPartialView(controllerContext, partialView.ViewName).View;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        var vc = new ViewContext(</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          controllerContext, partialView.View, partialView.ViewData, partialView.TempData, sw);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        partialView.View.Render(vc, sw);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        var partialViewString = sw.GetStringBuilder().ToString();</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        return partialViewString;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>I don&#x27;t know about you but I do love an extension method - it often makes for much more readable code. In this case we can use:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">var toolbarHtml = partialViewResult.ConvertToString(ControllerContext);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Which I think we can all agree is really rather lovely. Perhaps it would be more lovely if I didn&#x27;t have to pass <code>ControllerContext</code> <!-- -->-<!-- --> but hey! Still quite nice.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="favouring-composition-over-inheritance-testable">Favouring Composition over Inheritance (testable)<a aria-hidden="true" class="hash-link" href="#favouring-composition-over-inheritance-testable" title="Direct link to heading">​</a></h2><p>Although ASP.Net MVC was designed to be testable there are times when you think &quot;really? Can it be that hard?&quot;. In fact for a well thought through discussion on the topic I advise you read <a href="http://volaresystems.com/blog/post/2010/08/19/Dont-mock-HttpContext" target="_blank" rel="noopener noreferrer">this</a>. (I&#x27;m aware of the irony implicit in linking to another blog post in a blog post that I only wrote because I first linked to another blog which vanished.... Infinite recursion anybody?)</p><p>The conclusion of the linked blog post is twofold</p><ol><li>Don&#x27;t mock HTTPContext</li><li>Use the <a href="https://en.wikipedia.org/wiki/Facade_pattern" target="_blank" rel="noopener noreferrer">facade pattern</a> instead</li></ol><p>Having testable code is not a optional bauble in my view - it&#x27;s a necessity. So with my final approach that&#x27;s exactly what I&#x27;ll do.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">using System.Web.Mvc;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">namespace My.Interfaces</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  public interface IMvcInternals</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    string ConvertPartialViewToString(PartialViewResult partialView, ControllerContext controllerContext);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">// ....</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">using System.IO;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">using System.Web.Mvc;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">using My.Interfaces;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">namespace My.Utilities</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  public class MvcInternals : IMvcInternals</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    public string ConvertPartialViewToString(PartialViewResult partialView,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                                             ControllerContext controllerContext)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      using (var sw = new StringWriter())</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        partialView.View = ViewEngines.Engines</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          .FindPartialView(controllerContext, partialView.ViewName).View;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        var vc = new ViewContext(</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          controllerContext, partialView.View, partialView.ViewData, partialView.TempData, sw);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        partialView.View.Render(vc, sw);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        var partialViewString = sw.GetStringBuilder().ToString();</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        return partialViewString;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>So here I have a simple interface with a <code>ConvertPartialViewToString</code> method on it. This interface can be passed into a controller and then used like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">var toolbarHtml = _mvcInternals.ConvertPartialViewToString(partialViewResult, ControllerContext);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Ah... that&#x27;s the sweet mellifluous sound of easily testable code.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/sward">sward</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/partial-view">PartialView</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about PartialView.ToString()" href="/2015/03/20/partialview-tostring"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2013/05/04/how-im-using-cassette">How I&#x27;m Using Cassette part 1:Getting Up and Running</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2013-05-04T00:00:00.000Z" itemprop="datePublished">May 4, 2013</time> · <!-- -->6 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_31ik" id="backing-into-the-light">Backing into the light<a aria-hidden="true" class="hash-link" href="#backing-into-the-light" title="Direct link to heading">​</a></h2><p>For a while now, I&#x27;ve been seeking a bulletproof way to handle the following scenarios... all at the same time in the context of an ASP.Net MVC application:</p><ol><li>How to serve full-fat JavaScript in debug mode and minified in release mode</li><li>When debugging, ensure that the full-fat JS being served is definitely the latest version; and <!-- -->*<strong>not</strong>*<!-- --> from the cache. (The time I&#x27;ve wasted due to <a href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#304" target="_blank" rel="noopener noreferrer">304&#x27;s</a>...)</li><li>How to add Javascript assets that need to be served up from any point in an ASP.Net MVC application (including views, layouts, partial views... even controllers if so desired) whilst preventing duplicate scripts from being served.</li><li>How to ensure that Javascript files are served up last to any web page to ensure a speedy feel to users (don&#x27;t want JS blocking rendering).</li><li>And last but certainly not least the need to load Javascript files in dependency order. If <code>myView.js</code> depends on jQuery then clearly <code>jQuery-latest.js</code> needs to be served before <code>myView.js</code>.</li></ol><p>Now the best, most comprehensive and solid looking solution to this problem has for some time seemed to me to be <a href="http://aboutcode.net/" target="_blank" rel="noopener noreferrer">Andrew Davey&#x27;s</a><a href="http://getcassette.net/" target="_blank" rel="noopener noreferrer">Cassette</a>. This addresses all my issues in one way or another, as well as bringing in a raft of other features (support for Coffeescript etc).</p><p>However, up until now I&#x27;ve slightly shied away from using Cassette as I was under the impression it had a large number of dependencies. That doesn&#x27;t appear to be the case at all. I also had some vague notion that I could quite simply build my own solution to these problems making use of Microsoft&#x27;s <a href="http://nuget.org/packages/Microsoft.AspNet.Web.Optimization/1.0.0" target="_blank" rel="noopener noreferrer">Web Optimization</a> which nicely handles my #1 problem above. However, looking again at the documentation Cassette was promising to handle scenarios #1 - #5 without breaking sweat. How could I ignore that? I figured I should do the sensible thing and take another look at it. And, lo and behold, when I started evaluating it again it seemed to be just what I needed.</p><p>With the minumum of fuss I was able to get an ASP.Net MVC 4 solution up and running, integrated with Cassette, which dealt with all my scenarios very nicely indeed. I thought it might be good to write this up over a short series of posts and share what my finished code looks like. If you follow the steps I go through below it&#x27;ll get you started using Cassette. Or you could skip to the end of this post and look at the repo on GitHub. Here we go...</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="adding-cassette-to-a-raw-mvc-4-project">Adding Cassette to a raw MVC 4 project<a aria-hidden="true" class="hash-link" href="#adding-cassette-to-a-raw-mvc-4-project" title="Direct link to heading">​</a></h2><p>Fire up Visual Studio and create a new MVC 4 project (I used the internet template to have some content in place).</p><p>Go to the Package Manager Console and key in &quot;<code>Install-Package Cassette.Aspnet</code>&quot;. Cassette will install itself.</p><p>Now you&#x27;ve got Cassette in place you may as well pull out usage of Web Optimization as you&#x27;re not going to need it any more.Be ruthless, delete App_Start/BundleConfig.cs and delete the line of code that references it in Global.asax.cs. If you take the time to run the app now you&#x27;ll see you&#x27;ve miraculously lost your CSS and your JavaScript. The code referencing it is still in place but there&#x27;s nothing for it to serve up. Don&#x27;t worry about that - we&#x27;re going to come back and Cassette-ify things later on...</p><p>You&#x27;ll also notice you now have a CassetteConfiguration.cs file in your project. Open it. Replace the contents with this (I&#x27;ve just commented out the default code and implemented my own CSS and Script bundles based on what is available in the default template of an MVC 4 app):</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=CassetteConfiguration.cs"></script><p>In the script above I&#x27;ve created 4 bundles, 1 stylesheet bundle and 3 JavaScript bundles - each of these is roughly equivalent to Web Optimization bundles that are part of the MVC 4 template:</p><dl><dt>~/bundles/css</dt><dd>Our site CSS - this includes both our own CSS and the jQuery UI CSS as well. This is the rough equivalent of the Web Optimization bundles <em>~/Content/css</em> and <em>~/Content/themes/base/css</em> brought together.</dd><dt>~/bundles/head</dt><dd>What scripts we want served in the head tag - Modernizr basically. Do note the setting of the <em>PageLocation</em> property - the purpose of this will become apparent later. This is the direct equivalent of the Web Optimization bundle: <em>~/bundles/modernizr</em>.</dd><dt>~/bundles/core</dt><dd>The scripts we want served on every page. For this example project I&#x27;ve picked jQuery and jQuery UI. This is the rough equivalent of the Web Optimization bundles <em>~/bundles/jquery</em> and <em>~/bundles/jqueryui</em> brought together.</dd><dt>~/bundles/validate</dt><dd>The validation scripts (that are dependent on the core scripts). This is the rough equivalent of the Web Optimization bundle: <em>~/bundles/jqueryval</em>.</dd></dl><p>At this point we&#x27;ve set up Cassette in our project - although we&#x27;re not making use of it yet. If you want to double check that everything is working properly then you can fire up your project and browse to &quot;Cassette.axd&quot; in the root. You should see something a bit like this:</p><p><img src="https://1.bp.blogspot.com/-xM9iU6HjB7o/UWzjAN5EieI/AAAAAAAAAaA/EAXTTnD6vdY/s320/CassetteScripts.png"></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="how-web-optimization-and-cassette-differ">How Web Optimization and Cassette Differ<a aria-hidden="true" class="hash-link" href="#how-web-optimization-and-cassette-differ" title="Direct link to heading">​</a></h2><p>If you&#x27;re more familiar with the workings of Web Optimization than Cassette then it&#x27;s probably worth taking a moment to appreciate an important distinction between the slightly different ways each works.</p><p><strong>Web Optimization</strong></p><ol><li>Create bundles as desired.</li><li>Serve up bundles and / or straight JavaScript files as you like within your MVC views / partial views / layouts.</li></ol><p><strong>Cassette</strong></p><ol><li>Create bundles for <!-- -->*<strong>all</strong>*<!-- --> JavaScript files you wish to serve up. You may wish to create some bundles which consist of a number of a number of JavaScript files pushed together. But for each individual file you wish to serve you also need to create an individual bundle. (Failure to do so may mean you fall prey to the &quot;<em>Cannot find an asset bundle containing the path &quot;<!-- -->~<!-- -->/Scripts/somePath.js&quot;.</em>&quot;)</li><li>Reference bundles and / or individual JavaScript files in their individual bundles as you like within your MVC views / partial views / layouts / controllers / HTML helpers... the list goes on!</li><li>Render the referenced scripts to the page (typically just before the closing <code>body</code> tag)</li></ol><h2 class="anchor anchorWithStickyNavbar_31ik" id="making-use-of-our-bundles">Making use of our Bundles<a aria-hidden="true" class="hash-link" href="#making-use-of-our-bundles" title="Direct link to heading">​</a></h2><p>Now we&#x27;ve created our bundles let&#x27;s get the project serving up CSS and JavaScript using Cassette. First the layout file. Take the <code>_Layout.cshtml</code> file from this:</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=_LayoutBefore.cshtml"></script><p>To this:</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=_LayoutAfter.cshtml"></script><p>And now let&#x27;s take one of the views, <code>Login.cshtml</code> and take it from this:</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=LoginBefore.cshtml"></script><p>To this:</p><script src="https://gist.github.com/johnnyreilly/5393608.js?file=LoginAfter.cshtml"></script><p>So now you should be up and running with Cassette. If you want the code behind this then take I&#x27;ve put it on GitHub <a href="https://github.com/johnnyreilly/CassetteDemo" target="_blank" rel="noopener noreferrer">here</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/andrew-davey">Andrew Davey</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/cassette">cassette</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about How I&#x27;m Using Cassette part 1:Getting Up and Running" href="/2013/05/04/how-im-using-cassette"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2013/03/03/unit-testing-modelstate">Unit testing ModelState</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2013-03-03T00:00:00.000Z" itemprop="datePublished">March 3, 2013</time> · <!-- -->5 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><ul><li>Me: &quot;It can&#x27;t be done&quot;</li><li>Him: &quot;Yes it can&quot;</li><li>Me: &quot;No it can&#x27;t&quot;</li><li>Him: &quot;Yes it can, I&#x27;ve just done it&quot;</li><li>Me: &quot;Ooooh! Show me ...&quot;</li></ul><p>The above conversation (or one much like it) took place between my colleague Marc Talary and myself a couple of weeks ago. It was one of those faintly embarrassing situations where you state your case with absolute certainty only to subsequently discover that you were <!-- -->*<strong>completely</strong>*<!-- --> wrong. Ah arrogance, thy name is Reilly...</p><p>The disputed situation in this case was ModelState validation in ASP.Net MVC. How can you unit test a models validation driven by <code>DataAnnotations</code>? If at all. Well it can be done, and here&#x27;s how.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="simple-scenario">Simple scenario<a aria-hidden="true" class="hash-link" href="#simple-scenario" title="Direct link to heading">​</a></h2><p>Let&#x27;s start with a simple model:</p><script src="https://gist.github.com/johnnyreilly/5069901.js?file=CarModel.cs"></script><p>And let&#x27;s have a controller which makes use of that model:</p><script src="https://gist.github.com/johnnyreilly/5069901.js?file=CarController.cs"></script><p>When I was first looking at unit testing this I was slightly baffled by the behaviour I witnessed. I took an invalid model (where the properties set on the model were violating the model&#x27;s validation <code>DataAnnotations</code>):</p><script src="https://gist.github.com/johnnyreilly/5069901.js?file=NaomiCampbell.cs"></script><p>I passed the invalid model to the <code>Edit</code> controller action inside a unit test. My expectation was that the <code>ModelState.IsValid</code> code path would <!-- -->*<strong>not</strong>*<!-- --> be followed as this was <!-- -->*<strong>not</strong>*<!-- --> a valid model. So <code>ModelState.IsValid</code> should evaluate to <code>false</code>, right? Wrong!</p><p>Contrary to my expectation the validity of <code>ModelState</code> is not evaluated on the fly inside the controller. Rather it is determined during the model binding that takes place <!-- -->*<strong>before</strong>*<!-- --> the actual controller action method is called. And that completely explains why during my unit test with an invalid model we find we&#x27;re following the <code>ModelState.IsValid</code> code path.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="back-to-the-dispute">Back to the dispute<a aria-hidden="true" class="hash-link" href="#back-to-the-dispute" title="Direct link to heading">​</a></h2><p>As this blog post started off I was slightly missing Marc&#x27;s point. I thought he was saying we should be testing the <code>ModelState.IsValid == false</code> code path. And given that <code>ModelState</code> is determined before we reach the controller my view was that the only way to achieve this was through making use of <code>ModelState.AddModelError</code> in our unit test (you can read a good explanation of that <a href="http://stackoverflow.com/a/3816143/761388" target="_blank" rel="noopener noreferrer">here</a>). And indeed we were already testing for this; we were surfacing errors via a <code>JsonResult</code> and so had a test in place to ensure that <code>ModelState</code> errors were transformed in the manner we would expect.</p><p>However, Marc&#x27;s point was actually that we should have unit tests that enforced our design. That is to say, if we&#x27;d decided a certain property on a model was mandatory we should have a test that checked that this was indeed the case. If someone came along later and removed the <code>Required</code> data annotation then we wanted that test to fail.</p><p>It&#x27;s worth saying, we didn&#x27;t want a unit test to ensure that ASP.Net MVC worked as expected. Rather, where we had used DataAnnotations against our models to drive validation, we wanted to ensure the validation didn&#x27;t disappear further down the track. Just to be clear: we wanted to test our code, not Microsoft&#x27;s.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="now-i-get-to-learn-something">Now I get to learn something<a aria-hidden="true" class="hash-link" href="#now-i-get-to-learn-something" title="Direct link to heading">​</a></h2><p>When I grasped Marc&#x27;s point I thought that the the only way to write these tests would be to make use of reflection. And whilst we could certainly do that I wasn&#x27;t entirely happy with that as a solution. To my mind it was kind of testing &quot;at one remove&quot;, if you see what I mean. What I really wanted was to see that MVC was surfacing validations in the manner I might have hoped. And you can!</p><p>.... Drum roll... Ladies and gents may I present Marc&#x27;s <code>ModelStateTestController</code>:</p><script src="https://gist.github.com/johnnyreilly/5069901.js?file=ModelStateTestController.cs"></script><p>This class is, as you can see, incredibly simple. It is a controller, it inherits from <code>System.Web.Mvc.Controller</code> and establishes a mock context in the constructor using MOQ. This controller exposes a single method: <code>TestTryValidateModel</code>. This method internally determines the controller&#x27;s <code>ModelState</code> given the supplied object by calling off to Mvc&#x27;s (protected) <code>TryValidateModel</code> method (<code>TryValidateModel</code> evaluates <code>ModelState</code>).</p><p>This simple class allows us to test the validations on a model in a simple fashion that stays close to the way our models will actually be used in the wild. It&#x27;s pragmatic and it&#x27;s useful.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="an-example">An example<a aria-hidden="true" class="hash-link" href="#an-example" title="Direct link to heading">​</a></h2><p>Let me wrap up with an example unit test. The test below makes use of the <code>ModelStateTestController</code> to check the application of the DataAnnotations on our model:</p><script src="https://gist.github.com/johnnyreilly/5069901.js?file=ModelStateUnitTests.cs"></script><h2 class="anchor anchorWithStickyNavbar_31ik" id="wrapping-up">Wrapping up<a aria-hidden="true" class="hash-link" href="#wrapping-up" title="Direct link to heading">​</a></h2><p>In a way I think it&#x27;s a shame that <code>TryValidateModel</code> is a protected method. If it weren&#x27;t it would be simplicity to write a unit test which tested the ModelState directly in context of the action method. It would be possible to get round this by establishing a base controller class which all our controllers would inherit from which implemented the <code>TestTryValidateModel</code> method from above. On the other hand maybe it&#x27;s good to have clarity of the difference between testing model validations and testing controller actions. Something to ponder...</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/marc-talary">Marc Talary</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/data-annotations">DataAnnotations</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/controller">Controller</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/model-state">ModelState</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Unit testing ModelState" href="/2013/03/03/unit-testing-modelstate"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2013/01/09/twitterbootstrapmvc4-meet-bootstrap">Twitter.Bootstrap.MVC4 meet Bootstrap Datepicker</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2013-01-09T00:00:00.000Z" itemprop="datePublished">January 9, 2013</time> · <!-- -->4 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_31ik" id="update-14012013">Update 14/01/2013<a aria-hidden="true" class="hash-link" href="#update-14012013" title="Direct link to heading">​</a></h2><p>Since I wrote this I&#x27;ve taken things on a little further - to read about that go <a href="http://icanmakethiswork.blogspot.co.uk/2013/01/twitterbootstrapmvc4-meet-bootstrap_14.html" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="getting-responsive">Getting Responsive<a aria-hidden="true" class="hash-link" href="#getting-responsive" title="Direct link to heading">​</a></h2><p>It&#x27;s the new year, it&#x27;s time for new things. Long on my list of &quot;things to do&quot; was getting up to speed with <a href="http://en.wikipedia.org/wiki/Responsive_web_design" target="_blank" rel="noopener noreferrer">Responsive web design</a>. No doubt like everyone else I&#x27;ve been hearing more and more about this over the last year (by the way there was a <a href="http://mashable.com/2012/12/11/responsive-web-design/" target="_blank" rel="noopener noreferrer">good article on Mashable</a> about this last month). RWD (in case you don&#x27;t already know) is pretty much about having web interfaces that format their presentation based on the device they&#x27;re running to provide a good user experience. (I kind of think of it as a <a href="http://en.wikipedia.org/wiki/Write_once,_run_anywhere" target="_blank" rel="noopener noreferrer">write once, run anywhere</a> approach - though hopefully without the negative connotations...)</p><p>Rather than diving straight in myself I&#x27;d heard at a user group that it might be worth taking <a href="http://twitter.github.com/bootstrap/" target="_blank" rel="noopener noreferrer">Twitter Bootstrap</a> as a baseline. I&#x27;m a <strike>lazy</strike></p><p>busy fellow so this sounded ideal.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="i-like-aspnet-mvc">I like ASP.Net MVC...<a aria-hidden="true" class="hash-link" href="#i-like-aspnet-mvc" title="Direct link to heading">​</a></h2><p>... and this flavoured my investigations. I quickly stumbled on an <a href="http://lostechies.com/erichexter/2012/11/20/twitter-bootstrap-mvc4-the-template-nuget-package-for-asp-net-mvc4-projects/" target="_blank" rel="noopener noreferrer">article written by Eric Hexter</a>. Eric had brought together Twitter Bootstrap and ASP.Net MVC 4 in a <a href="http://nuget.org/packages/twitter.bootstrap.mvc4" target="_blank" rel="noopener noreferrer">NuGet package</a>. Excellent work chap!</p><p>To get up and running with Eric&#x27;s work was a straightforward proposition. I...</p><ol><li>Created new MVC 4 application in Visual Studio called “BootstrapMvcSample” using the “Empty” Project Template.</li><li>Executed the following commands at the NuGet Package Manager Console: - <code>Install-Package twitter.bootstrap.mvc4</code><ul><li><code>Install-Package twitter.bootstrap.mvc4.sample</code></li></ul></li></ol><p>Check out the responsive goodness I had when I ran it:</p><p><img src="https://4.bp.blogspot.com/-2ytMlGLGRpo/UO1mqfi7yQI/AAAAAAAAAYs/RRuVGbr8nAg/s400/TwitterBootstrapFullSize.png"></p><p><img src="https://3.bp.blogspot.com/-780OCEuXoLw/UO1maRJ-CZI/AAAAAAAAAYg/chBHgYMAIJk/s400/TwitterBootstrapTitchyTiny.png"></p><p>This is just 1 page, with <code>@media</code> queries doing the heavy lifting.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="bootstrap-datepicker">Bootstrap Datepicker<a aria-hidden="true" class="hash-link" href="#bootstrap-datepicker" title="Direct link to heading">​</a></h2><p>The eagle-eyed amongst you will have noticed that the edit screen above features a date field. I&#x27;ve long been a fan of datepickers to allow users to enter a date in an application in an intuitive fashion. Until native browser datepickers become the norm we&#x27;ll be relying on some kind of component. Up until now my datepicker of choice has been the <a href="http://jqueryui.com/datepicker/" target="_blank" rel="noopener noreferrer">jQuery UI one</a>. Based on a quick Google it seemed that jQuery UI and Twitter Bootstrap were not necessarily natural bedfellows. (Though <a href="http://addyosmani.github.com/jquery-ui-bootstrap/" target="_blank" rel="noopener noreferrer">Addy Osmani&#x27;s jQuery UI Bootstrap</a> shows some promise...)</p><p>Since I feared ending up down a blind alley I found myself casting around for a Twitter Bootstrap datepicker. I quickly happened upon <a href="http://www.eyecon.ro/bootstrap-datepicker/" target="_blank" rel="noopener noreferrer">Stefan Petre&#x27;s Bootstrap Datepicker</a> which looked just the ticket.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="shake-hands-and-play-nice">Shake hands and play nice...<a aria-hidden="true" class="hash-link" href="#shake-hands-and-play-nice" title="Direct link to heading">​</a></h2><p>Incorporating the Bootstrap Datepicker into Twitter.Bootstrap.MVC4 was actually a pretty straightforward affair. I added the following datepicker assets to the ASP.Net MVC project as follows:</p><ul><li><code>bootstrap-datepicker.js</code> was added to <code>~\Scripts</code>.</li><li><code>datepicker.css</code> was added to <code>~\Content</code>. I renamed this file to <code>bootstrap-datepicker.css</code> to stay in line with the other css files.</li></ul><p>Once this was done I amended the <code>BootstrapBundleConfig.cs</code> bundles to include these assets. Once this was done the bundle file looked like this:</p><script src="https://gist.github.com/4529746.js?file=BootstrapBundleConfig.cs"></script><p>I then created this folder:<code>~\Views\Shared\EditorTemplates</code>. To this folder I added the following <code>Date.cshtml</code> Partial to hold the datepicker EditorTemplate: (Having this in place meant that properties with the <code>[DataType(DataType.Date)]</code> attribute would automatically use this EditorTemplate when rendering an editor - I understand <code>[UIHint]</code> attributes can be used to the same end.)</p><script src="https://gist.github.com/4529746.js?file=Date.cshtml"></script><p>And finally I amended the <code>Create.cshtml</code> View (which perhaps more accurately might be called the Edit View?) to include a bit of JavaScript at the bottom to initialise any datepickers on the screen.</p><script src="https://gist.github.com/4529746.js?file=Create.cshtml"></script><p>Et voilà - it works!</p><p><img src="https://4.bp.blogspot.com/-_SfaYN2dfuk/UO2JmrqO_gI/AAAAAAAAAZA/Y904hmwcqaI/s400/TwitterBootstrapDatepicker.png"></p><p>My thanks to <a href="https://twitter.com/ehexter" target="_blank" rel="noopener noreferrer">Eric Hexter</a> and Stefan Petre for doing all the hard work!</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="still-to-do">Still to do<a aria-hidden="true" class="hash-link" href="#still-to-do" title="Direct link to heading">​</a></h2><p>I haven&#x27;t really tested how this all fits together (if at all) with browsers running a non-English culture. There may still be a little tinkering require to get that working...</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/twitter-bootstrap-mvc-4">Twitter.Bootstrap.MVC4</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/responsive">Responsive</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/twitter-bootstrap">Twitter Bootstrap</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/bootstrap-datepicker">Bootstrap Datepicker</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Twitter.Bootstrap.MVC4 meet Bootstrap Datepicker" href="/2013/01/09/twitterbootstrapmvc4-meet-bootstrap"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/09/06/globalize-and-jquery-validate">Globalize and jQuery Validation</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-09-06T00:00:00.000Z" itemprop="datePublished">September 6, 2012</time> · <!-- -->4 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_31ik" id="update-05102015">Update 05/10/2015<a aria-hidden="true" class="hash-link" href="#update-05102015" title="Direct link to heading">​</a></h2><p>If you&#x27;re after a version of this that works with Globalize 1.x then take a look <a href="https://blog.johnnyreilly.com/2015/10/jquery-validation-globalize-hits-10.html" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="update-27082013">Update 27/08/2013<a aria-hidden="true" class="hash-link" href="#update-27082013" title="Direct link to heading">​</a></h2><p>To make it easier for people to use the approach detailed in this post I have created a repository for <code>jquery.validate.globalize.js</code> on GitHub <a href="https://github.com/johnnyreilly/jquery-validation-globalize" target="_blank" rel="noopener noreferrer">here</a>.</p><p>This is also available as a nuget package <a href="https://www.nuget.org/packages/jQuery.Validation.Globalize/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>To see a good demo take a look <a href="http://jqueryvalidationunobtrusivenative.azurewebsites.net/AdvancedDemo/Globalize" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="background">Background<a aria-hidden="true" class="hash-link" href="#background" title="Direct link to heading">​</a></h2><p><a href="http://icanmakethiswork.blogspot.co.uk/2012/05/globalizejs-number-and-date.html" target="_blank" rel="noopener noreferrer">I&#x27;ve written before about a great little library called Globalize</a> which makes locale specific number / date formatting simple within JavaScript. And I&#x27;ve just stumbled upon an <a href="http://www.hanselman.com/blog/GlobalizationInternationalizationAndLocalizationInASPNETMVC3JavaScriptAndJQueryPart1.aspx" target="_blank" rel="noopener noreferrer">old post written by Scott Hanselman about the business of Globalisation / Internationalisation / Localisation within ASP.NET</a>. It&#x27;s a great post and I recommend reading it (I&#x27;m using many of the approaches he discusses).</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="jquery-global-is-dead-long-live-globalize">jQuery Global is dead... Long live Globalize!<a aria-hidden="true" class="hash-link" href="#jquery-global-is-dead-long-live-globalize" title="Direct link to heading">​</a></h2><p>However, there&#x27;s one tweak I would make to Scotts suggestions and that&#x27;s to use Globalize in place of the jQuery Global plugin. The jQuery Global plugin has now effectively been reborn as Globalize (with no dependancy on jQuery). As far as I can tell jQuery Global is now disappearing from the web - certainly the link in Scotts post is dead now at least. I&#x27;ve <del>ripped off</del> been inspired by the &quot;Globalized jQuery Unobtrusive Validation&quot; section of Scotts article and made <code>jquery.validate.globalize.js</code>.</p><p>And for what it&#x27;s worth <code>jquery.validate.globalize.js</code> applies equally to standard jQuery Validation as well as to jQuery Unobtrusive Validation. I say that as the above JavaScript is effectively a monkey patch to the number / date / range / min / max methods of jQuery.validate.js which forces these methods to use Globalize&#x27;s parsing support instead.</p><p>Here&#x27;s the JavaScript:</p><script src="https://gist.github.com/3651751.js?file=jquery.validate.globalize.js"></script><p>The above script does 2 things. Firstly it monkey patches jquery.validate.js to make use of Globalize.js number and date parsing in place of the defaults. Secondly it initialises Globalize to relevant current culture driven by the <code>html lang</code> property. So if the html tag looked like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">html</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">de-DE</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">html</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Then Globalize would be initialised with the &quot;de-DE&quot; culture assuming that culture was available and had been served up to the client. (By the way, the Globalize initialisation logic has only been placed in the code above to demonstrate that Globalize needs to be initialised to the culture. It&#x27;s more likely that this initialisation step would sit elsewhere in a &quot;proper&quot; app.)</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="wait-wheres-html-lang-getting-set">Wait, where&#x27;s <code>html lang</code> getting set?<a aria-hidden="true" class="hash-link" href="#wait-wheres-html-lang-getting-set" title="Direct link to heading">​</a></h2><p>In Scott&#x27;s article he created a <code>MetaAcceptLanguage</code> helper to generate a META tag like this: <code>&amp;lt;meta name=&quot;accept-language&quot; content=&quot;en-GB&quot; /&amp;gt;</code> which he used to drive Globalizes specified culture.</p><p>Rather than generating a meta tag I&#x27;ve chosen to use the <code>lang</code> attribute of the <code>html</code> tag to specify the culture. I&#x27;ve chosen to do this as it&#x27;s more in line with the <a href="http://www.w3.org/TR/i18n-html-tech-lang/#ri20030510.102829377" target="_blank" rel="noopener noreferrer">W3C spec</a>. But it should be noted this is just a different way of achieving exactly the same end.</p><p>So how&#x27;s it getting set? Well, it&#x27;s no great shakes; in my <code>_Layout.cshtml</code> file my html tag looks like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">html</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">@System.Globalization.CultureInfo.CurrentUICulture.Name</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">html</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And in my <code>web.config</code> I have following setting set:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><pre tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">configuration</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">system.web</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">globalization</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">culture</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">auto</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">uiCulture</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">auto</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">&lt;!--- Other stuff.... --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">system.web</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">configuration</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>With both of these set this means I get <code>&amp;lt;html lang=&quot;de-DE&quot;&amp;gt;</code> or <code>&amp;lt;html lang=&quot;en-GB&quot;&amp;gt;</code> etc. depending on a users culture.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="serving-up-the-right-globalize-culture-files">Serving up the right Globalize culture files<a aria-hidden="true" class="hash-link" href="#serving-up-the-right-globalize-culture-files" title="Direct link to heading">​</a></h2><p>In order that I send the correct Globalize culture to the client I&#x27;ve come up with this static class which provides the user with the relevant culture URL (falling back to the en-GB culture if it can&#x27;t find one based your culture):</p><script src="https://gist.github.com/3651751.js?file=GlobalizeUrls.cs"></script><h2 class="anchor anchorWithStickyNavbar_31ik" id="putting-it-all-together">Putting it all together<a aria-hidden="true" class="hash-link" href="#putting-it-all-together" title="Direct link to heading">​</a></h2><p>To make use of all of this together you&#x27;ll need to have the <code>html lang</code> attribute set as described earlier and some scripts output in your layout page like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script src=&quot;@Url.Content(&quot;~/Scripts/jquery.js&quot;)&quot; type=&quot;text/javascript&quot;&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">@Url.Content(GlobalizeUrls.Globalize)</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">@Url.Content(GlobalizeUrls.GlobalizeCulture)</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script src=&quot;@Url.Content(&quot;~/Scripts/jquery.validate.js&quot;)&quot; type=&quot;text/javascript&quot;&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script src=&quot;@Url.Content(&quot;~/scripts/jquery.validate.globalize.js&quot;)&quot; type=&quot;text/javascript&quot;&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">@* Only serve the following script if you need it: *@</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script src=&quot;@Url.Content(&quot;~/scripts/jquery.validate.unobtrusive.js&quot;)&quot; type=&quot;text/javascript&quot;&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Which will render something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/Scripts/jquery.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/Scripts/globalize.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">  </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/scripts/globalize/globalize.culture.en-GB.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">  </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/Scripts/jquery.validate.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">  </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/Scripts/jquery.validate.globalize.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">  </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">  </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">/Scripts/jquery.validate.unobtrusive.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">  </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will load up jQuery, Globalize, your Globalize culture, jQuery Validate, jQuery Validates unobtrusive extensions (which you don&#x27;t need if you&#x27;re not using them) and the jQuery Validate Globalize script which will set up culture aware validation.</p><p>Finally and just to re-iterate, it&#x27;s highly worthwhile to give <a href="http://www.hanselman.com/blog/GlobalizationInternationalizationAndLocalizationInASPNETMVC3JavaScriptAndJQueryPart1.aspx" target="_blank" rel="noopener noreferrer">Scott Hanselman&#x27;s original article a look</a>. Most all the ideas in here were taken wholesale from him!</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/internationalisation">Internationalisation</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/globalization">Globalization</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/globalize-js">Globalize JS</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/localisation">Localisation</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/j-query-validation">jQuery Validation</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/j-query-validate-js">jQuery.validate.js</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Globalize and jQuery Validation" href="/2012/09/06/globalize-and-jquery-validate"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/08/24/how-to-attribute-encode-partialview-in">How to attribute encode a PartialView in MVC (Razor)</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-08-24T00:00:00.000Z" itemprop="datePublished">August 24, 2012</time> · <!-- -->3 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>This post is plagiarism. But I&#x27;m plagiarising myself so I don&#x27;t feel too bad.</p><p>I posted a <a href="http://stackoverflow.com/q/12093005/761388" target="_blank" rel="noopener noreferrer">question</a> on StackOverflow recently asking if there was a simple way to attribute encode a PartialView in Razor / ASP.NET MVC. I ended up answering my own question and since I thought it was a useful solution it might be worth sharing.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="the-question">The Question<a aria-hidden="true" class="hash-link" href="#the-question" title="Direct link to heading">​</a></h2><p>In the project I was working on I was using PartialViews to store the HTML that would be rendered in a tooltip in my ASP.NET MVC application. (In case you&#x27;re curious I was using the <a href="http://jquerytools.org/demos/tooltip/index.html" target="_blank" rel="noopener noreferrer">jQuery Tools library for my tooltip</a> effect.)</p><p>I had thought that Razor, clever beast that it is, would automatically attribute encode anything sat between quotes in my HTML. Unfortunately this doesn&#x27;t appear to be the case. In the short term I was able to workaround this by using single quotation marks to encapsulate my PartialViews HTML. See below for an example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><pre tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">tooltip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">     </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">title</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">@Html.Partial(</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">_MyTooltipInAPartial</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">)</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    Some content</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now this worked just fine but I was aware that if any PartialView needed to use single quotation marks I would have a problem. Let&#x27;s say for a moment that <code>_MyTooltipInAPartial.cshtml</code> contained this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><pre tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">span</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">style</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">color:green</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">fjkdsjf&#x27;lksdjdlks</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Well when I used my handy little single quote workaround, the following would result:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><pre tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;div class=&quot;tooltip&quot;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">     title=&#x27;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">span</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">style</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">color:green</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">fjkdsjf&#x27;lksdjdlks</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">&#x27;&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    Some content</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Which although it doesn&#x27;t show up so well in the code sample above is definite <em>&quot;does not compute, does not compute, does not compute <!-- -->*<!-- -->LOUD EXPLOSION<!-- -->*<!-- -->&quot;</em> territory.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="the-answer">The Answer<a aria-hidden="true" class="hash-link" href="#the-answer" title="Direct link to heading">​</a></h2><p>This took me back to my original intent which was to encapsulate the HTML in double quotes like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><pre tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">tooltip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">     </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">title</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">@Html.Partial(</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">_MyTooltipInAPartial&quot;)&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    Some content</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Though with the example discussed above we clearly had a problem whether we used single or double quotes. What to do?</p><p>Well the answer wasn&#x27;t too complicated. After a little pondering I ended up scratching my own itch by writing an HTML helper method called <code>PartialAttributeEncoded</code> which made use of <code>HttpUtility.HtmlAttributeEncode</code> to HTML attribute encode a PartialView.</p><p>Here&#x27;s the code:</p><script src="https://gist.github.com/3449462.js?file=PartialExtensions.cs"></script><p>Using the above helper is simplicity itself:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><pre tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">tooltip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">     </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">title</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">@Html.PartialAttributeEncoded(</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">_MyTooltipInAPartial&quot;)&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    Some content</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And, given the example I&#x27;ve been going through, it would provide you with this output:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><pre tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">tooltip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token tag" style="color:rgb(127, 219, 202)">     </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">title</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value entity named-entity" style="color:rgb(127, 219, 202)">&amp;lt;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">span style=</span><span class="token tag attr-value entity named-entity" style="color:rgb(127, 219, 202)">&amp;quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">color:green</span><span class="token tag attr-value entity named-entity" style="color:rgb(127, 219, 202)">&amp;quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">&gt;fjkdsjf</span><span class="token tag attr-value entity" style="color:rgb(127, 219, 202)">&amp;#39;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">lksdjdlks&lt;/span&gt;</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    Some content</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now the HTML in the title attribute above might be an unreadable mess - but it&#x27;s the unreadable mess you need. That&#x27;s what the HTML we&#x27;ve been discussing looks like when it&#x27;s been encoded.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="final-thoughts">Final thoughts<a aria-hidden="true" class="hash-link" href="#final-thoughts" title="Direct link to heading">​</a></h2><p>I was surprised that Razor didn&#x27;t handle this out of the box. I wonder if this is something that will come along with a later version? It&#x27;s worth saying that I experienced this issue when working on an MVC 3 application. It&#x27;s possible that this issue may actually have been solved with MVC 4 already; I haven&#x27;t had chance to check yet though.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/encode">encode</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/partial-view">PartialView</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/razor">razor</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/attribute">attribute</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about How to attribute encode a PartialView in MVC (Razor)" href="/2012/08/24/how-to-attribute-encode-partialview-in"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/07/16/rendering-partial-view-to-string">Rendering Partial View to a String</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-07-16T00:00:00.000Z" itemprop="datePublished">July 16, 2012</time> · <!-- -->5 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_31ik" id="well-done-that-man">Well done that man!<a aria-hidden="true" class="hash-link" href="#well-done-that-man" title="Direct link to heading">​</a></h2><p>Every now and then I&#x27;m thinking to myself &quot;<em>wouldn&#x27;t it be nice if you could do x...</em>&quot; And then I discover that someone else has thought the self same thoughts and better yet they have the answer! I had this situation recently and discovered the wonderful Kevin Craft had been there, done that and made the T-shirt. Here&#x27;s his blog: <a href="http://craftycodeblog.com/2010/05/15/asp-net-mvc-render-partial-view-to-string/" target="_blank" rel="noopener noreferrer">http://craftycodeblog.com/2010/05/15/asp-net-mvc-render-partial-view-to-string/</a> I wanted to talk about how this simple post provided me with an elegant solution to something I&#x27;ve found niggling and unsatisfactory for a while now... ## How it helped</p><p>Just last week I was thinking about <code>Partial Views</code>. Some background. I&#x27;m working on an ASP.NET MVC 3 project which provides users with a nice web interface to manage the workflow surrounding certain types of financial asset. The user is presented with a web page which shows a kind of grid to the user. As the user hovers over a row they are presented with a context menu which allows them to perform certain workflow actions. If they perform an action then that row will need to be updated to reflect this. Back in the day this would have been achieved by doing a full postback to the server. At the server the action would be taken, the persistent storage updated and then the whole page would be served up to the user again with the relevant row of HTML updated but everything else staying as is. Now there&#x27;s nothing wrong with this approach as such. I mean it works just fine. But in my case since I knew that it was only that single row of HTML that was going to be updated and so I was loath to re-render the whole page. It seemed a waste to get so much data back from the server when only a marginal amount was due to change. And also I didn&#x27;t want the user to experience the screen refresh flash. Looks ugly. Now in the past when I&#x27;ve had a solution to this problem which from a UI perspective is good but from a development perspective slightly unsatisfactory. I would have my page call a controller method (via <code>jQuery.ajax</code>) to perform the action. This controller would return a <code>JsonResult</code> indicating success or failure and any data necessary to update the screen. Then in the <code>success</code> function I would manually update the HTML on the screen using the data provided. Now this solution works but there&#x27;s a problem. <a href="http://en.wikipedia.org/wiki/Rolf_Harris" target="_blank" rel="noopener noreferrer">Can you tell what it is yet?</a> It&#x27;s not very DRY. I&#x27;m repeating myself. When the page is initially rendered I have a <code>View</code> which renders (in this example) all the relevant HTML for the screen <!-- -->*<!-- -->including<!-- -->*<!-- --> the HTML for my rows of data. And likewise I have my JavaScript method for updating the screen too. So with this solution I have duplicated my GUI logic. If I update 1, I need to update the other. It&#x27;s not a massive hardship but it is, as I say, unsatisfactory. I was recently thinking that it would be nice if I could refactor my row HTML into a <code>Partial View</code> which I could then use in 2 places: 1. In my standard <code>View</code> as I iterated through each element for display and 2. Nested inside a <code>JsonResult</code>...</p><p>The wonderful thing about approach 2 is that it allows me to massively simplify my <code>success</code> to this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;myRowSelector&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">empty</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">html</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">RowHTML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//Where RowHTML is the property that</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//contains my stringified PartialView</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>and if I later make changes to the <code>Partial View</code> these changes will not require me to make any changes to my JavaScript at all. Brilliant! And entirely satisfactory. On the grounds that someone else might have had the same idea I did a little googling around. Sure enough I discovered <a href="http://craftycodeblog.com/2010/05/15/asp-net-mvc-render-partial-view-to-string/" target="_blank" rel="noopener noreferrer">Kevin Craft&#x27;s post</a> which was just the ticket. It does exactly what I&#x27;d hoped. Besides being a nice and DRY solution this approach has a number of other advantages as well: - Given it&#x27;s a <code>Partial View</code> the Visual Studio IDE provides a nice experience when coding it up with regards to intellisense / highlighting etc. Not something available when you&#x27;re hand coding up a string which contains the HTML you&#x27;d like passed back...</p><ul><li>A wonderful debug experience. You can debug the rendering of a <code>Partial View</code> being rendered to a string in the same way as if the ASP.NET MVC framework was serving it up. I could have lived without this but it&#x27;s fantastic to have it available.</li><li>It&#x27;s possible to nest <!-- -->*<strong>multiple</strong>*<!-- --> <code>Partial Views</code> within your <code>JsonResult</code>. THIS IS WONDERFUL!!! This means that if several parts of your screen need to be updated (perhaps the row and a status panel as well) then as long as both are refactored into a <code>Partial View</code> you can generate them on the fly and pass them back.</li></ul><p>Excellent stuff!</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/kevin-craft">Kevin Craft</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/partial-view">PartialView</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/json-result">JsonResult</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Rendering Partial View to a String" href="/2012/07/16/rendering-partial-view-to-string"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/07/01/how-im-structuring-my-javascript-in-web">Optimally Serving Up JavaScript</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-07-01T00:00:00.000Z" itemprop="datePublished">July 1, 2012</time> · <!-- -->7 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>I have occasionally done some server-side JavaScript with Rhino and Node.js but this is the exception rather than the rule. Like most folk at the moment, almost all the JavaScript I write is in a web context.</p><p>Over time I&#x27;ve come to adopt a roughly standard approach to how I structure my JavaScript; both the JavaScript itself and how it is placed / rendered in the an HTML document. I wanted to write about the approach I&#x27;m using. Partly just to document the approach but also because I often find writing about something crystalises my feelings on the subject in one way or another. I think that most of what I&#x27;m doing is sensible and rational but maybe as I write about this I&#x27;ll come to some firmer conclusions about my direction of travel.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="what-are-you-up-to">What are you up to?<a aria-hidden="true" class="hash-link" href="#what-are-you-up-to" title="Direct link to heading">​</a></h2><p>Before I get started it&#x27;s probably worth mentioning the sort of web development I&#x27;m generally called to do (as this has obviously influenced my decisions).</p><p>Most of my work tends to be on web applications used internally within a company. That is to say, web applications accessible on a Company intranet. Consequently, the user base for my applications tends to be smaller than the Amazons and Googles of this world. It almost invariably sits on the ASP.NET stack in some way. Either classic WebForms or MVC.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="render-first-js-second">&quot;Render first. JS second.&quot;<a aria-hidden="true" class="hash-link" href="#render-first-js-second" title="Direct link to heading">​</a></h2><p>I took 2 things away from <a href="http://www.stevesouders.com/blog/2010/09/30/render-first-js-second/" target="_blank" rel="noopener noreferrer">Steve Souder&#x27;s article</a>:</p><ol><li>Async script loading is better than synchronous script loading</li><li>Get your screen rendered and <!-- -->*<strong>then</strong>*<!-- --> execute your JavaScript</li></ol><p>I&#x27;m not doing any async script loading as yet; although I am thinking of giving it a try at some point. In terms of choosing a loader I&#x27;ll probably give RequireJS first crack of the whip (purely as it looks like most people are tending it&#x27;s direction and that can&#x27;t be without reason).</p><p>However - it seems that the concept of async script loading is kind of conflict with one of the other tenets of web wisdom: script bundling. Script bundling, if you&#x27;re not already aware, is the idea that you should combine all your scripts into a single file and then just serve that. This prevents multiple HTTP requests as each script loads in. Async script loading is obviously okay with multiple HTTP requests, presumably because of the asynchronous non-blocking pattern of loading. So. 2 different ideas. And there&#x27;s further movement on this front right now as <a href="http://www.hanselman.com/blog/VisualStudio2012RCIsReleasedTheBigWebRollup.aspx" target="_blank" rel="noopener noreferrer">Microsoft are baking in script bundling to .NET 4.5</a>.</p><p>Rather than divide myself between these 2 horses I have at the moment tried to follow the &quot;JS second&quot; part of this advice in my own (perhaps slightly old fashioned) way...</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="i-want-to-serve-you">I want to serve you...<a aria-hidden="true" class="hash-link" href="#i-want-to-serve-you" title="Direct link to heading">​</a></h2><p>I have been making sure that scripts are the last thing served to the screen by using a customised version of <a href="http://frugalcoder.us/post/2009/06/29/Handling-Scripts-in-ASPNet-MVC.aspx" target="_blank" rel="noopener noreferrer">Michael J. Ryan&#x27;s HtmlHelper</a>. This lovely helper allows you to add script references as required from a number of different sources (layout page, view, partial view etc - even the controller if you so desired). It&#x27;s simple to control the ordering of scripts by allowing you to set a priority for each script which determines the render order.</p><p>Then as a final step before rendering the <code>&amp;lt;/body&amp;gt;</code> tag the scripts can be rendered in one block. By this point the web page is rendered visually and a marginal amount of blocking is, in my view, acceptable.</p><p>If anyone is curious - the class below is my own version of Michael&#x27;s helper. My contribution is the go faster stripes relating to the caching suffix and the ability to specify dependancies using script references rather than using numeric priority mechanism):</p><script src="https://gist.github.com/3019159.js?file=ScriptExtensions.cs"></script><h2 class="anchor anchorWithStickyNavbar_31ik" id="minification---i-want-to-serve-you-less">Minification - I want to serve you less...<a aria-hidden="true" class="hash-link" href="#minification---i-want-to-serve-you-less" title="Direct link to heading">​</a></h2><p>Another tweak I made to the script helper meant that when compiling either the debug or production (minified) versions of common JS files will be included if available. This means in a production environment the users get minified JS files so faster loading. And in a development environment we get the full JS files which make debugging more straightforward.</p><p>What I haven&#x27;t started doing is minifying my own JS files as yet. I know I&#x27;m being somewhat inconsistent here by sometimes serving minified files and sometimes not. I&#x27;m not proud. Part of my rationale for this that since most of my users use my apps on a daily basis they will for the most part be using cached JS files. Obviously there&#x27;ll be slightly slower load times the first time they go to a page but nothing that significant I hope.</p><p>I have thought of starting to do my own minification as a build step but have held off for now. Again this is something being baked into .NET 4.5; another reason why I have held off doing this a different way for now.</p><p>Update</p><p>It now looks like this Microsofts optimisations have become <a href="http://nuget.org/packages/Microsoft.AspNet.Web.Optimization" target="_blank" rel="noopener noreferrer">this Nuget package</a>. It&#x27;s early days (well it was released on 15th August 2012 and I&#x27;m writing this on the 16th) but I think this looks not to be tied to MVC 4 or .NET 4.5 in which case I could use it in my current MVC 3 projects. I hope so...</p><p>By the way there&#x27;s a <a href="http://www.pluralsight.com/training/Courses/TableOfContents/mvc4#mvc4-m3-optimization" target="_blank" rel="noopener noreferrer">nice rundown of how to use this by K. Scott Allen of Pluralsight</a>. It&#x27;s fantastic. Recommended.</p><p>Update 2</p><p>Having done a little asking around I now understand that this <!-- -->*<strong>can</strong>*<!-- --> be used with MVC 3 / .NET 4.0. Excellent!</p><p>One rather nice alternative script serving mechanism I&#x27;ve seen (but not yet used) is Andrew Davey&#x27;s <a href="http://getcassette.net" target="_blank" rel="noopener noreferrer">Cassette</a> which I mean to take for a test drive soon. This looks fantastic (and is available as a <a href="http://nuget.org/packages/Cassette" target="_blank" rel="noopener noreferrer">Nuget package</a> <!-- -->-<!-- --> 10 points!).</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="cdns-they-want-to-serve-you">CDNs (they want to serve you)<a aria-hidden="true" class="hash-link" href="#cdns-they-want-to-serve-you" title="Direct link to heading">​</a></h2><p>I&#x27;ve never professionally made use of CDNs at all. There are <a href="http://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/" target="_blank" rel="noopener noreferrer">clearly good reasons why you should</a> but most of those good reasons relate most to public facing web apps.</p><p>As I&#x27;ve said, the applications I tend to work on sit behind firewalls and it&#x27;s not always guaranteed what my users can see from the grand old world of web beyond. (Indeed what they see can change on hour by hour basis sometimes...) Combined with that, because my apps are only accessible by a select few I don&#x27;t face the pressure to reduce load on the server that public web apps can face.</p><p>So while CDN&#x27;s are clearly a good thing. I don&#x27;t use them at present. And that&#x27;s unlikely to change in the short term.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="tldr">TL:DR<a aria-hidden="true" class="hash-link" href="#tldr" title="Direct link to heading">​</a></h2><ol><li>I don&#x27;t use CDNs - they&#x27;re clearly useful but they don&#x27;t suit my particular needs</li><li>I serve each JavaScript file individually just before the body tag. I don&#x27;t bundle.</li><li>I don&#x27;t minify my own scripts (though clearly it wouldn&#x27;t be hard) but I do serve the minified versions of 3rd party libraries (eg jQuery) in a Production environment.</li><li>I don&#x27;t use async script loaders at present. I may in future; we shall see.</li></ol><p>I expect some of the above may change (well, possibly not point #1) but this general approach is working well for me at present.</p><p>I haven&#x27;t touched at all on how I&#x27;m structuring my JavaScript code itself. Perhaps next time.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/asp-net-mvc">asp.net mvc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/html-helper">html helper</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/javascript">javascript</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/cassette">cassette</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Optimally Serving Up JavaScript" href="/2012/07/01/how-im-structuring-my-javascript-in-web"><b>Read More</b></a></div></footer></article></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items"><li class="footer__item"><a href="https://www.buymeacoffee.com/qUBm0Wh" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;"></a></li><li class="footer__item"><div style="display: flex; align-items: center;"><iframe src="https://github.com/sponsors/johnnyreilly/button" title="Sponsor johnnyreilly" height="35" width="116" style="border: 0;"></iframe><div>&nbsp;on GitHub</div></div></li></ul></div><div class="col footer__col"><div class="footer__title">Feeds</div><ul class="footer__items"><li class="footer__item"><a href="https://blog.johnnyreilly.com/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://blog.johnnyreilly.com/atom.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Atom<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9adf4245.js"></script>
<script src="/assets/js/main.7a281289.js"></script>
</body>
</html>