<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="I CAN MAKE THIS WORK RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="I CAN MAKE THIS WORK Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-51754530-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="icon" href="/img/favicon/profile.jpg">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/favicon/apple-touch-icon.png"><title data-react-helmet="true">4 posts tagged with &quot;json&quot; | I CAN MAKE THIS WORK</title><meta data-react-helmet="true" property="og:title" content="4 posts tagged with &quot;json&quot; | I CAN MAKE THIS WORK"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" name="twitter:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" property="og:url" content="https://blog.johnnyreilly.com/tags/json"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-react-helmet="true" name="robots" content="max-image-preview:large"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://blog.johnnyreilly.com/tags/json"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/tags/json" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/tags/json" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ff16c2af.css">
<link rel="preload" href="/assets/js/runtime~main.d9e5fcff.js" as="script">
<link rel="preload" href="/assets/js/main.a95d529d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">I CAN MAKE THIS WORK</b></a><a class="navbar__item navbar__link" href="/about">About</a><a class="navbar__item navbar__link" href="/blog-archive">Blog Archive</a><a class="navbar__item navbar__link" href="/talks">Talks</a></div><div class="navbar__items navbar__items--right"><a href="https://polywork.johnnyreilly.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Polywork<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-tags-post-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/12/19/azure-container-apps-bicep-and-github-actions">Azure Container Apps, Bicep and GitHub Actions</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/12/12/open-graph-sharing-previews-guide">Open Graph: a guide to sharable social media previews</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/12/05/azure-static-web-app-deploy-previews-with-azure-devops">Azure Static Web App Deploy Previews with Azure DevOps</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/11/22/typescript-vs-jsdoc-javascript">TypeScript vs JSDoc JavaScript</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/11/18/azure-standard-tests-with-bicep">Azure standard availability tests with Bicep</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>4 posts tagged with &quot;json&quot;</h1><a href="/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/04/28/beg-steal-or-borrow-decent-javascript">Beg, Steal or Borrow a Decent JavaScript DateTime Converter</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-04-28T00:00:00.000Z" itemprop="datePublished">April 28, 2012</time> Â· <!-- -->7 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>I&#x27;ve so named this blog post because it shamelessly borrows from the fine work of others: Sebastian MarkbÃ¥ge and Nathan Vonnahme. Sebastian wrote a blog post documenting a good solution to the ASP.NET JavaScriptSerializer DateTime problem at the tail end of last year. However, his solution didn&#x27;t get me 100% of the way there when I tried to use it because of a need to support IE 8 which lead me to use Nathan Vonnahme&#x27;s ISO 8601 JavaScript Date parser. I thought it was worth documenting this, hence this post, but just so I&#x27;m clear; the hard work here was done by Sebastian MarkbÃ¥ge and Nathan Vonnahme and not me. Consider me just a curator in this case. The original blog posts that I am drawing upon can be found here: 1. <a href="http://blog.calyptus.eu/seb/2011/12/custom-datetime-json-serialization/" target="_blank" rel="noopener noreferrer">http://blog.calyptus.eu/seb/2011/12/custom-datetime-json-serialization/</a> and here: 2. <a href="http://n8v.enteuxis.org/2010/12/parsing-iso-8601-dates-in-javascript/" target="_blank" rel="noopener noreferrer">http://n8v.enteuxis.org/2010/12/parsing-iso-8601-dates-in-javascript/</a></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="datetime-json-javascript-dates">DateTime, JSON, JavaScript Dates....<a aria-hidden="true" class="hash-link" href="#datetime-json-javascript-dates" title="Direct link to heading">â€‹</a></h2><p>Like many, I&#x27;ve long been frustrated with the quirky DateTime serialisation employed by the <code>System.Web.Script.Serialization.JavaScriptSerializer</code> class. When serialising DateTimes so they can be JSON.parsed on the client, this serialiser uses the following approach: (from MSDN) <a href="http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx" target="_blank" rel="noopener noreferrer"><em>Date object, represented in JSON as &quot;\/Date(number of ticks)\/&quot;. The number of ticks is a positive or negative long value that indicates the number of ticks (milliseconds) that have elapsed since midnight 01 January, 1970 UTC.&quot;</em></a> Now this is not particularly helpful in my opinion because it&#x27;s not human readable (at least not this human; perhaps <a href="http://stackoverflow.com/users/22656/jon-skeet" target="_blank" rel="noopener noreferrer">Jon Skeet</a>...) When consuming your data from web services / PageMethods using <a href="http://api.jquery.com/jQuery.ajax/" target="_blank" rel="noopener noreferrer">jQuery.ajax</a> you are landed with the extra task of having to convert what were DateTimes on the server from Microsofts string Date format (eg <code>&quot;\/Date(1293840000000)\/&quot;</code>) into actual JavaScript Dates. It&#x27;s also unhelpful because it&#x27;s divergent from the approach to DateTime / Date serialisation used by a native JSON serialisers: <img src="/assets/images/FireBug-Dates-0636f61333c7811fd9a8a56078638bb5.png"></p><p>Just as an aside it&#x27;s worth emphasising that one of the limitations of JSON is that the JSON.parsing of a JSON.stringified date will <!-- -->*<strong>not</strong>*<!-- --> return you to a JavaScript Date but rather an ISO 8601 date string which will need to be subsequently converted into a Date. Not JSON&#x27;s fault - essentially down to the absence of a Date literal within JavaScript. ## Making JavaScriptSerializer behave more JSON&#x27;y</p><p>Anyway, I didn&#x27;t think there was anything I could really do about this in an ASP.NET classic / WebForms world because, to my knowledge, it is not possible to swap out the serialiser that is used. JavaScriptSerializer is the only game in town. (Though I am optimistic about the future; given the announcement that I first picked up on Rick Strahl&#x27;s blog that <a href="http://www.west-wind.com/weblog/posts/2012/Mar/09/Using-an-alternate-JSON-Serializer-in-ASPNET-Web-API" target="_blank" rel="noopener noreferrer">Json.NET was going to be adopted as the default JSON serializer for ASP.NET Web API</a>; what with Json.NET having out-of-the-box <a href="http://james.newtonking.com/archive/2009/02/20/good-date-times-with-json-net.aspx" target="_blank" rel="noopener noreferrer">ISO 8601 support</a>. I digress...) Because it can make debugging a much more straightforward process I place a lot of value on being able to read the network traffic that web apps generate. It&#x27;s much easier to drop into Fiddler / FireBug / Chrome dev tools etc and watch what&#x27;s happening there and then instead of having to manually process the data separately first so that you can understand it. I think this is nicely aligned with the <a href="http://en.wikipedia.org/wiki/KISS_principle" target="_blank" rel="noopener noreferrer">KISS principle</a>. For that reason I&#x27;ve been generally converting DateTimes to ISO 8601 strings on the server before returning them to the client. A bit of extra overhead but generally worth it for the gains in clarity in my opinion. So I was surprised and delighted when I happened upon <a href="http://blog.calyptus.eu/seb/2011/12/custom-datetime-json-serialization/" target="_blank" rel="noopener noreferrer">Sebastian MarkbÃ¥ge&#x27;s blog post</a> which provided a DateTime JavaScriptConverter that could be plugged into the JavaScriptSerializer. You can see the code below (or on Sebastian&#x27;s original post with a good explanation of how it works): <script src="https://gist.github.com/2489976.js?file=DateTimeJavaScriptConverter.cs"></script></p><p>Using this converter meant that a DateTime that previously would have been serialised as <code>&quot;\/Date(1293840000000)\/&quot;</code> would now be serialised as <code>&quot;2011-01-01T00:00:00.0000000Z&quot;</code> instead. This is entirely agreeable because 1. it&#x27;s entirely clear what a <code>&quot;2011-01-01T00:00:00.0000000Z&quot;</code> style date represents and 2. this is more in line with native browser JSON implementations and <code>&amp;lt;statingTheObvious&amp;gt;</code>consistency is a good thing.<code>&amp;lt;/statingTheObvious&amp;gt;</code></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="getting-your-web-services-to-use-the-iso-8601-datetime-converter">Getting your web services to use the ISO 8601 DateTime Converter<a aria-hidden="true" class="hash-link" href="#getting-your-web-services-to-use-the-iso-8601-datetime-converter" title="Direct link to heading">â€‹</a></h2><p>Sebastian alluded in his post to a <code>web.config</code> setting that could be used to get web services / pagemethods etc. implementing his custom DateTime serialiser. This is it: <script src="https://gist.github.com/2489976.js?file=web.config"></script></p><p>With this in place your web services / page methods will happily be able to serialise / deserialise ISO style date strings to your hearts content. ## What no ISO 8601 date string Date constructor?</p><p>As I mentioned earlier, Sebastian&#x27;s solution didn&#x27;t get me 100% of the way there. There was still a fly in the ointment in the form of IE 8. Unfortunately IE 8 doesn&#x27;t have JavaScript <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/parse" target="_blank" rel="noopener noreferrer">Date constructor that takes ISO 8601 date strings</a>. This lead me to using Nathan Vonnahme&#x27;s ISO 8601 JavaScript Date parser, the code of which is below (or see his original post <a href="http://n8v.enteuxis.org/2010/12/parsing-iso-8601-dates-in-javascript/" target="_blank" rel="noopener noreferrer">here</a>): <script src="https://gist.github.com/2489976.js?file=parseISO8601Date.js"></script></p><p>With this in place I could parse ISO 8601 Dates just like anyone else. Great stuff. <code>parseISO8601Date(&quot;2011-01-01T00:00:00.0000000Z&quot;)</code> would give me a JavaScript Date of <code>Sat Jan 1 00:00:00 UTC 2011</code>. Obviously in the fullness of time the parseISO8601Date solution should no longer be necessary because <a href="http://es5.github.com/#x15.9.3.2" target="_blank" rel="noopener noreferrer">EcmaScript 5 specifies an ISO 8601 date string constructor</a>. However, in the interim Nathan&#x27;s solution is a lifesaver. Thanks again both to Sebastian MarkbÃ¥ge and Nathan Vonnahme who have both generously allowed me use their work as the basis for this post. ## PS And it would have worked if it wasn&#x27;t for that pesky IE 9...</p><p>Subsequent to writing this post I thought I&#x27;d check that IE 9 had implemented a JavaScript Date constructor that would process an ISO 8601 date string like this: <code>new Date(&quot;2011-01-01T00:00:00.0000000Z&quot;)</code>. It hasn&#x27;t. Take a look: <img src="/assets/images/IE9%2B%2528shakes%2Bfist%2529-fd45569f1f35097a7029f2b79244da80.png"></p><p>This is slightly galling as the above code works dandy in Firefox and Chrome. As you can see from the screenshot you can get the JavaScript IE 9 Date constructor to play nice by trimming off the final 4 &quot;0&quot;&#x27;s from the string. Frustrating. Obviously we can still use Nathan&#x27;s solution but it&#x27;s a shame that we can&#x27;t use the native support. Based on what I&#x27;ve read <a href="http://msdn.microsoft.com/en-us/library/az4se3k1.aspx#Roundtrip" target="_blank" rel="noopener noreferrer">here</a> I think it would be possible to amend Sebastians serializer to fall in line with IE 9&#x27;s pendantry by changing this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">return new CustomString(((DateTime)obj).ToUniversalTime()</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  .ToString(&lt;b&gt;&quot;O&quot;&lt;/b&gt;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">return new CustomString(((DateTime)obj).ToUniversalTime()</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  .ToString(&lt;b&gt;&quot;yyyy&#x27;-&#x27;MM&#x27;-&#x27;dd&#x27;T&#x27;HH&#x27;:&#x27;mm&#x27;:&#x27;ss&#x27;.&#x27;fffzzz&quot;&lt;/b&gt;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>I&#x27;ve held off from doing this myself as I rather like Sebastian&#x27;s idea of being able to use Microsoft&#x27;s Round-trip (&quot;O&quot;, &quot;o&quot;) Format Specifier. And it seems perverse that we should have to move away from using Microsoft&#x27;s Round-trip Format Specifier purely because of (Microsoft&#x27;s) IE! But it&#x27;s a possibility to consider and so I put it out there. I would hope that MS will improve their JavaScript Date constructor with IE 10. A missed opportunity if they don&#x27;t I think. ## PPS Just when you thought is over... IE 9 was right!</p><p>Sebastian got in contact after I first published this post and generously pointed out that, contrary to my expectation, IE 9 technically had the correct implementation. According to the <a href="http://es5.github.com/#x15.9.1.15" target="_blank" rel="noopener noreferrer">EMCAScript standard</a> the Date constructor should not allow more than millisecond precision. In this case, Chrome and Firefox are being less strict - not more correct. On reflection this does rather make sense as the result of a <code>JSON.stringify(new Date())</code> never results in an ISO date string to the 10 millionths of a second detail. Sebastian has himself stopped using Microsoft&#x27;s Round-trip (&quot;O&quot;, &quot;o&quot;) Format Specifier in favour of this format string: ```cs
return new CustomString(((DateTime)obj).ToUniversalTime()</p><p>.ToString(<b>&quot;yyyy-MM-ddTHH:mm:ss.fffZ&quot;</b>)</p><p>);</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"> This results in date strings that comply perfectly with the ECMAScript spec. I suspect I&#x27;ll switch to using this also now. Though I&#x27;ll probably leave the first part of the post intact as I think the background remains interesting. Thanks again Sebastian!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/date">Date</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/sebastian-markbage">Sebastian MarkbÃ¥ge</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/date-time">DateTime</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/system-web-script-serialization-java-script-serializer">System.Web.Script.Serialization.JavaScriptSerializer</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/emca-script-standard">EMCAScript standard</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/json">json</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/javascript">javascript</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/serialization">Serialization</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/nathan-vonnahme">Nathan Vonnahme</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Beg, Steal or Borrow a Decent JavaScript DateTime Converter" href="/2012/04/28/beg-steal-or-borrow-decent-javascript"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/02/23/joy-of-json">The Joy of JSON</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-02-23T00:00:00.000Z" itemprop="datePublished">February 23, 2012</time> Â· <!-- -->4 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>So back to JSON. For those of you that don&#x27;t know JSON stands for JavaScript Object Notation and is lightweight text based data interchange format. Rather than quote other people verbatim you can find thorough explanations of JSON here: - <a href="http://www.json.org/" target="_blank" rel="noopener noreferrer">Introducing JSON</a></p><ul><li><a href="http://www.json.org/js.html" target="_blank" rel="noopener noreferrer">JSON in Javascript</a></li></ul><p>As mentioned in my previous <a href="http://icanmakethiswork.blogspot.com/2012/02/potted-history-of-using-ajax-on.html" target="_blank" rel="noopener noreferrer">post on Ajax</a> I came upon JSON quite by accident and was actually using it for some time without having any idea. But let&#x27;s pull back a bit. Let&#x27;s start with the JavaScript Object Literal. Some years ago I came upon this article by Christan Heilmann about the JavaScript Object Literal which had been published all the way back in 2006: <a href="http://christianheilmann.com/2006/02/16/show-love-to-the-object-literal/" target="_blank" rel="noopener noreferrer">Show love to the JavaScript Object Literal</a> Now when I read this it was a revelation to me. I hadn&#x27;t really used JavaScript objects a great deal at this point (yes I am one of those people that started using JavaScript without actually learning the thing) and when I had used them is was through the <code>var obj = new Object()</code> pattern (as that&#x27;s the only approach I knew). So it was wonderful to discover that instead of the needlessly verbose:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> myCar </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 139)">Object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">myCar</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">wheels</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">myCar</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">colour</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;blue&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>I could simply use the much more concise object literal syntax to declare an object instead:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> myCar </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> wheels</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> colour</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;blue&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Lovely. Henceforth I adopted this approach in my code as I&#x27;m generally a believer that brevity is best. It was sometime later that I happened upon JSON (when I started looking into <a href="http://icanmakethiswork.blogspot.com/2012/01/jqgrid-its-just-far-better-grid.html" target="_blank" rel="noopener noreferrer">jqGrid</a>). Basically I was looking to pass complex data structures backward and forward to the server and, as far as I knew, there was no way to achieve this simply in JavaScript. I was expecting that I would have to manually serialise and deserialise (yes dammit I will use the English spellings!) objects when ever I wanted to do this sort of thing. However, I was reading the the fantastic Dave Ward&#x27;s <a href="http://encosia.com/" target="_blank" rel="noopener noreferrer">Encosia</a> blog which on this occasion was talking about the <a href="http://encosia.com/why-aspnet-ajax-updatepanels-are-dangerous/" target="_blank" rel="noopener noreferrer">troubles of UpdatePanels</a> (a subject close to my heart by the way) and more interestingly the use of PageMethods in ASP.NET. This is what he said that made me prick up my ears: <em>&quot;Page methods allow ASP.NET AJAX pages to directly execute a pageâ€™s static methods, using JSON (JavaScript Object Notation). JSON is basically a minimalistic version of SOAP, which is perfectly suited for light weight communication between client and server.&quot;</em> JSON is a lightweight SOAP eh? I&#x27;ve used SOAP. I wonder if I could use this.... To my complete surprise, and may I say delight, I discovered that a wonderful fellow called Douglas Crockford, he of <a href="http://www.amazon.co.uk/JavaScript-Good-Parts-Douglas-Crockford/dp/0596517742" target="_blank" rel="noopener noreferrer">JavaScript, The Good Parts</a> fame had quietly come up with JSON some time ago. JSON, from my perspective, turned out to be a simple way to turn an object into a string and then from a string back into an object. So simple that it consists of 2 methods on a JSON object: - JSON.stringify(myObject) - take an object and make me a JSON string. (and by the way isn&#x27;t &quot;stringify&quot; just the loveliest method name ever?)</p><ul><li>JSON.parse(myJSONString) - take a JSON string and make me an object</li></ul><p>Let me illustrate the above method names using the myCar example from earlier:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> myCar </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> wheels</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> colour</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;blue&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// myCar is an object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> myCarJSON </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 139)">JSON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">stringify</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">myCar</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//myCarJSON will look like this: &#x27;{&quot;wheels&quot;:4,&quot;colour&quot;:&quot;blue&quot;}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> anotherCarMadeFromMyJSON </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 139)">JSON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">parse</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">myCarJSON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//anotherCarMadeFromMyJSON will be a brand new &quot;car&quot; object</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>I&#x27;ve also demonstrated this using the Chrome Console: <img src="/assets/images/Using%2BJSON-0f1a0f07ce8c22d14839611811e27af6.png"></p><p>Crockford initially invented/discovered JSON himself and wrote a little helper library which provided a JSON object to be used by all and sundry. This can be found here: <a href="https://github.com/douglascrockford/JSON-js" target="_blank" rel="noopener noreferrer">JSON on GitHub</a> Because JSON was so clearly wonderful, glorious and useful it ended up becoming a part of the EcmaScript 5 spec (in fact it&#x27;s worth reading the brilliant <a href="http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/" target="_blank" rel="noopener noreferrer">John Resig&#x27;s blog post</a> on this). This has lead to JSON being offered <a href="http://en.wikipedia.org/wiki/JSON#Native_encoding_and_decoding_in_browsers" target="_blank" rel="noopener noreferrer">natively in browsers</a> for quite some time. However, for those of us (and I am one alas) still supporting IE 6 and the like we still have Crockfords JSON2.js to fall back on.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/dave-ward">Dave Ward</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/json">json</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/encosia">Encosia</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/christian-heilmann-javascript-object-literal">Christian Heilmann javascript object literal</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/douglas-crockford">douglas crockford</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about The Joy of JSON" href="/2012/02/23/joy-of-json"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/02/05/potted-history-of-using-ajax-on">A Potted History of using Ajax (on the Microsoft Stack of Love)</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-02-05T00:00:00.000Z" itemprop="datePublished">February 5, 2012</time> Â· <!-- -->8 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>This post originally started out as an explanation of JSON. However as I wrote this quickly got abandoned in favour of writing about how I came to use JSON in the first place - which was through the use of Ajax. Having written a goodly amount I&#x27;ve now decided to move the actual JSON stuff into another post since I think Ajax is probably worth thinking about by itself rather than as an aside. So let me start at the beginning and explain how I came to use Ajax in the first place (this may take some time so please bear with me). In late 2004 I first started working on a project which I was to remain involved with (on and off) for a very long time indeed. The project was part financial reporting system and part sales incentivisation tool; it was used internally in the investment bank in which I was working. The project had been in existence for a number of years and had a web front end which at that point would been built in a combination of HTML, JavaScript, classic ASP and with a Visual Basic 6.0 back end. One of the reasons I had been brought on to the project was to help &quot;.Net-ify&quot; the thing and migrate it to ASP.NET and C#. I digress. The interesting thing about this app was that there were actually some quite advanced things being done with it (despite the classic ASP / VB). The users could enter trades into the system which represented actual trades that had been entered into a trading system elsewhere in the organisation. These trades would be assigned a reporting value which would be based on their various attributes. (Stay with me people this will get more interesting I <!-- -->*<strong>promise</strong>*<!-- -->.) The calculation of the reporting value was quite an in depth process and needed to be performed server-side. However, the users had decreed that it wasn&#x27;t acceptable to do a full postback to the server to perform this calculation; they wanted it done &quot;on-the-fly&quot;. Now if you asked me at the time I&#x27;d have said &quot;can&#x27;t be done&quot;. Fortunately the other people working on the project then weren&#x27;t nearly so defeatist. Instead they went away and found Microsoft&#x27;s <a href="http://msdn.microsoft.com/en-us/library/ie/ms531033%28v=vs.85%29.aspx" target="_blank" rel="noopener noreferrer">webservice.htc</a> library. For those of you that don&#x27;t know this was a JavaScript library that Microsoft came up with to enable the access of Web Services on the client. Given that it was designed to work with IE 5 I suspect it was created between 1999-2001 (but I&#x27;m not certain about that). Now it came as a revelation to me but this was a JavaScript library that talked to our web services through the medium of XML. In short it was my first encounter with anything remotely <a href="http://en.wikipedia.org/wiki/Ajax_(programming)" target="_blank" rel="noopener noreferrer">Ajax</a>-<!-- -->y. It was exciting! However, the possibilities of what we could do didn&#x27;t actually become apparent to me for some years. It&#x27;s worth saying that the way we were using webservice.htc was exceedingly simplistic and rather than investigating further I took the limited ways we were using it as indications of the limitations of Ajax and / or webservice.htc. So for a long time I thought the following: - The only way to pass multiple arguments to a web service was to package up arguments into a single string with delimiters which you could <a href="http://en.wikipedia.org/wiki/Comparison_of_programming_languages_(string_functions)#split" target="_blank" rel="noopener noreferrer">split</a> and unpackage as your first step on the server.</p><ul><li>The only valid return type was a single string. And so if you wanted to return a number of numeric values (as we did) the only way to do this was to package up return values into a very long string with delimiters in and (you guessed it!) <a href="http://en.wikipedia.org/wiki/Comparison_of_programming_languages_(string_functions)#split" target="_blank" rel="noopener noreferrer">split</a> and unpackage as your first step on the client.</li><li>The only thing that you could (or would want to) send back and forth between client and server was XML</li></ul><p>So to recap, I&#x27;m now aware that it&#x27;s possible for JavaScript to interact with the server through the use of web services. It&#x27;s possible, but ugly, not that quick and requires an awful lot of manual serialization / deserialization operations. It&#x27;s clearly powerful but not much fun at all. And that&#x27;s where I left it for a number of years. Let&#x27;s fade to black... It&#x27;s now 2007 and Microsoft have released ASP.NET Ajax, the details of which are well explained in this <a href="http://msdn.microsoft.com/en-us/magazine/cc163499.aspx" target="_blank" rel="noopener noreferrer">article</a> (which I have only recently discovered). Now I&#x27;m always interested in &quot;the new&quot; and so I was naturally interested in this. Just to be completely upfront about this I should confess that when I first discovered ASP.NET Ajax I didn&#x27;t clock the power of it at all. Initially I just switched over from using webservice.htc to ASP.NET Ajax. This alone gave us a <!-- -->*<strong>massive</strong>*<!-- --> performance improvement (I know it was massive since we actually received a &quot;well done&quot; email from our users which is testament to the difference it was making to their experience of the system). But we were still performing our manual serialisation / deserialisation of values on the client and the server. ie. Using Ajax was now much faster but still not too much fun. Let&#x27;s jump forward in time again to around 2010 to the point in time when I was discovering jQuery and that JavaScript wasn&#x27;t actually evil. It&#x27;s not unusual for me to play around with &quot;what if&quot; scenarios in my code, just to see what might might be possible. Sometimes I discover things. So it was with JSON. We had a web service in the system that allowed us to look up a counterparty (ie a bank account) with an identifier. Once we looked it up we packaged up the counterparty details (eg name, location etc) into a big long string with delimiters and sent it back to client. One day I decided to change the return type on the web service from a string to the actual counterparty class. So we went from something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">[WebService(Namespace = &quot;http://tempuri.org/&quot;)]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">[ScriptService]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">public class CounterpartyWebService : System.Web.Services.WebService</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  [WebMethod]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  public string GetCounterparty(string parameters)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    string[] aParameters = parameters.Split(&quot;|&quot;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    int counterpartyId = int.Parse(aParameters[0]);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    bool includeLocation = (aParameters[1] == &quot;1&quot;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    Counterparty counterparty = \_counterpartyDb</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    .GetCounterparty(counterpartyId);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        string returnValue = counterparty.Id +</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                          &quot;|&quot; + counterparty.Name +</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                          (includeLocation</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                            ? &quot;|&quot; + counterparty.Location</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                            : &quot;&quot;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        return returnValue;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">[WebMethod]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">public Counterparty GetCounterparty(string parameters)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  string[] aParameters = parameters.Split(&quot;|&quot;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  int counterpartyId = int.Parse(aParameters[0]);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  bool includeLocation = (aParameters[1] == &quot;1&quot;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  Counterparty counterparty = _counterpartyDb</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    .GetCounterparty(counterpartyId);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  return counterparty;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>I genuinely expected that this was just going to break. It didn&#x27;t. Suddenly on the client I&#x27;m sat there with a full blown object that looks just like the object I had on the server. <strong>WHAT BLACK MAGIC COULD THIS BE??????????</strong> Certain that I&#x27;d discovered witchcraft I decided to try something else. What would happen if I changed the signature on the method so it received individual parameters and passed my individual parameters to the web service instead of packaging them up into a string? I tried this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">[WebMethod]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">public Counterparty GetCounterparty(int counterpartyId, bool includeLocation)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  Counterparty counterparty = \_counterpartyDb</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  .GetCounterparty(counterpartyId);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  return counterparty;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And it worked! <strong><a href="http://www.youtube.com/watch?v=N_dWpCy8rdc&amp;feature=related" target="_blank" rel="noopener noreferrer">IT WORKED!!!!!!!!!!!!!!!!!!!!!</a></strong> (And yes I know I wasn&#x27;t actually using the includeLocation parameter - but the point was it was being passed to the server and I could have used it if I&#x27;d wanted to.) I couldn&#x27;t believe it. For <strong>years</strong> I&#x27;d been using Ajax and without <strong>any</strong> idea of the power available to me. The ignorance! The stupidity of the man! To my complete surprise it turned out that: - Ajax could be quick! ASP.NET Ajax was lightening fast when compared to webservice.htc</p><ul><li>You could send multiple arguments to a web service without all that packaging nonsense</li><li>You could return complex objects without the need for packaging it all up yourself.</li></ul><p>Essentially the source of all this goodness was the magic of JSON. I wouldn&#x27;t really come to comprehend this until I moved away from using the ASP.NET Ajax client libraries in favour of using the <a href="http://api.jquery.com/jQuery.ajax/" target="_blank" rel="noopener noreferrer">jQuery.ajax</a> functionality. (Yes, having mostly rattled on about using webservice.htc and ASP.NET Ajax I should clarify that I have now forsaken both for jQuery as I find it more powerful and more configurable - but it&#x27;s the journey that counts I guess!) It&#x27;s abysmal that I didn&#x27;t discover the power of Ajax sooner but the difference this discovery made to me was immense. Approaches that I would have dismissed or shied away from previously because of the amount of &quot;plumbing&quot; involved now became easy. This massively contributed to my <a href="http://www.hanselman.com/blog/HanselminutesPodcast260NETAPIDesignThatOptimizesForProgrammerJoyWithJonathanCarter.aspx" target="_blank" rel="noopener noreferrer">programmer joy</a>! Next time I promise I&#x27;ll aim to actually get onto JSON.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/ajax">ajax</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/jquery">jquery</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/webservice-htc">webservice.htc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/json">json</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/microsoft">microsoft</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about A Potted History of using Ajax (on the Microsoft Stack of Love)" href="/2012/02/05/potted-history-of-using-ajax-on"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/01/14/jqgrid-its-just-far-better-grid">jqGrid - it&#x27;s just a far better grid</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-01-14T00:00:00.000Z" itemprop="datePublished">January 14, 2012</time> Â· <!-- -->6 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>The year was 2010 (not really that long ago I know) and the project that I was working on was sorely in need of a new grid component. It was an <a href="http://www.asp.net/web-forms" target="_blank" rel="noopener noreferrer">ASP.NET WebForms</a> project and for some time we&#x27;d been using what was essentially a glorified <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.aspx" target="_blank" rel="noopener noreferrer">datagrid</a> which had a few extra features implemented to allow us to change column order / columns displayed / copy contents to clipboard etc. Our grid worked perfectly fine - it gave us the functionality we needed. However, it looked pretty terrible, and had some &quot;quirky&quot; approaches in place for supporting IE and Firefox side by side. Also, at the time we were attempting to make our app seem new and exciting again for the users. The surprising truth is that users seem to be more impressed with a visual revamp than with new or amended functionality. So I was looking for something which would make them sit up and say &quot;oooh - isn&#x27;t it pretty!&quot;. Unfortunately the nature of the organisation I was working for was not one that lended itself to paying for components. They were occasionally willing to do that but the hoops that would have to be jumped through first, the forms that would need to be signed in triplicate by people that had nearly nothing to do with the project made that an unattractive prospect. So I began my search initially looking at the various open source offerings that were around. As a minimum I was looking for something that would do what our home-grown component did already (change column order / columns displayed / copy contents to clipboard etc) but hopefully in a &quot;nicer&quot; way. Also, I had long been unhappy with the fact that to get our current grid to render results we did a <!-- -->*<strong>full postback</strong>*<!-- --> to the server and re-rendered the whole page. Pointless! Why should you need to do all this each time when you only wanted to refresh the data? Instead I was thinking about using an <a href="http://en.wikipedia.org/wiki/Ajax_%28programming%29" target="_blank" rel="noopener noreferrer">Ajax</a> approach; a grid that could just get the data that it needed and render it to the client. This seemed to me a vastly &quot;cleaner&quot; solution - why update a whole screen when you only want to update a small part of it? Why not save yourself the trouble of having to ensure that all other screen controls are persisted just as you&#x27;d like them after the postback? I also thought it was probably something that would scale better as it would massively reduce the amount of data moving backwards and forwards between client and server. No need for a full page life cycle on the server each time the grid refreshes. Just simple data travelling down the pipes of web. With the above criteria in mind I set out on my Google quest for a grid. Quite soon I found that there was a component out there which seemed to do all that I wanted and far more besides. It was called <a href="http://www.trirand.com/blog/" target="_blank" rel="noopener noreferrer">jqGrid</a>: <img src="/assets/images/jqgrid%2Bin%2Ball%2Bits%2Bglory-f7e587f63d55c27e275ac5fb1a2c49eb.png"></p><p>Oooh look at the goodness! It had both column re-ordering and column choosing built in!: This was a <!-- -->*<strong>very promising sign</strong>*<!-- -->! Now it&#x27;s time for me to demonstrate my ignorance. According to the website this grid component was a &quot;jQuery plugin&quot;. At the time I read this I had no idea what jQuery was at all - let alone what a plugin for it was. Anyway, I don&#x27;t want to get diverted so let&#x27;s just say that reading this lead to me getting an urgent education about some of the client side aspects of the modern web that I had been previously unaware of. I digress. This component did exactly what I wanted in terms of just sending data down the pipe. jqGrid worked with a whole number of possible data sources; XML, Array but the most exciting for me was obviously <a href="http://www.json.org/" target="_blank" rel="noopener noreferrer">JSON</a>. Take a look a the grid rendered below and the JSON that powered it (all from a simple <a href="http://www.trirand.com/blog/jqgrid/server.php?q=2&amp;_search=false&amp;nd=1326531357333&amp;rows=10&amp;page=1&amp;sidx=id&amp;sord=desc" target="_blank" rel="noopener noreferrer">GET</a> request): <img src="/assets/images/Check%2Bout%2Bthe%2BJSON-e7db6bd065ebcdaa42f52bfe069a9f57.png"></p><p>As you can see from the above screenshot, the grid has populated itself using the results of a web request. The only information that has gone to the server are the relevant criteria to drive the search results. The only information that has come back from the server is the data needed to drive the grid. Simple. Beautiful. I loved it and I wanted to use it. So I did! I had to take a few steps that most people thinking about using a grid component probably wont need to. First of all I had to write an ASP.Net WebForms wrapper for jqGrid which could be implemented in a similar way to our current custom datagrid. This was because, until the users were convinced that the new grid was better than the old both had to co-exist in the project and the user would have the option to switch between the two. This WebForms wrapper plugged into our old school XML column definition files and translated them into JSON for the grid. It also took <a href="http://msdn.microsoft.com/en-us/library/system.data.dataset.aspx" target="_blank" rel="noopener noreferrer">datasets</a> (which drove our old grid) and translated them into jqGrid-friendly JSON. I wanted to power the jqGrid using WebMethods on ASPX&#x27;s. After a little digging I found <a href="http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/" target="_blank" rel="noopener noreferrer">Dave Ward of Encosia&#x27;s post</a> which made it very simple (and in line with this I switched over from <a href="http://en.wikipedia.org/wiki/GET_%28HTTP%29#Request_methods" target="_blank" rel="noopener noreferrer">GET</a> requests to <a href="http://en.wikipedia.org/wiki/POST_%28HTTP%29" target="_blank" rel="noopener noreferrer">POSTs</a>). Finally I wrote some custom javascript which added a button to jqGrid which, if clicked, would copy the contents of the jqGrid to the clipboard (this was the only bit of functionality that didn&#x27;t appear to be implemented out of the box with jqGrid). I think I&#x27;m going to leave it there for now but I just wanted to say that I think jqGrid is a fantastic component and it&#x27;s certainly made my life better! It&#x27;s: - well supported, there is lots on <a href="http://stackoverflow.com/questions/tagged/jqgrid" target="_blank" rel="noopener noreferrer">StackOverflow</a> and the like about it</p><ul><li>there are regular <a href="http://www.trirand.com/blog/" target="_blank" rel="noopener noreferrer">releases / upgrades</a></li><li>there are good online <a href="http://trirand.com/blog/jqgrid/jqgrid.html" target="_blank" rel="noopener noreferrer">demonstrations</a> and <a href="http://www.trirand.com/jqgridwiki/doku.php" target="_blank" rel="noopener noreferrer">documentation</a></li></ul><p>I think Tony Tomov (the man behind jqGrid) has come up with something truly brilliant. It&#x27;s worth saying that the equally brilliant jQueryUI team are in the process of writing an official <a href="http://wiki.jqueryui.com/w/page/34246941/Grid" target="_blank" rel="noopener noreferrer">jQuery UI grid component</a> which uses jqGrid as one of its inspirations. However, this is still a long way from even a &quot;zero feature&quot; release. In the meantime jqGrid is continuing to go from strength to strength and as such I heartily recommend it. Finally, you can take a look at jqGrid&#x27;s source on <a href="https://github.com/tonytomov/jqGrid" target="_blank" rel="noopener noreferrer">GitHub</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/jqgrid">jqgrid</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/ajax">ajax</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/jquery">jquery</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/datagrid">datagrid</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/dave-ward">Dave Ward</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/json">json</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/no-postback">no postback</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/encosia">Encosia</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/tony-tomov">tony tomov</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about jqGrid - it&#x27;s just a far better grid" href="/2012/01/14/jqgrid-its-just-far-better-grid"><b>Read More</b></a></div></footer></article></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items"><li class="footer__item"><a href="https://www.buymeacoffee.com/qUBm0Wh" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;"></a></li><li class="footer__item"><div style="display: flex; align-items: center;"><iframe src="https://github.com/sponsors/johnnyreilly/button" title="Sponsor johnnyreilly" height="35" width="116" style="border: 0;"></iframe><div>&nbsp;on GitHub</div></div></li></ul></div><div class="col footer__col"><div class="footer__title">Feeds</div><ul class="footer__items"><li class="footer__item"><a href="https://blog.johnnyreilly.com/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://blog.johnnyreilly.com/atom.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Atom<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d9e5fcff.js"></script>
<script src="/assets/js/main.a95d529d.js"></script>
</body>
</html>