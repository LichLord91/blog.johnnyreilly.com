<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="I CAN MAKE THIS WORK RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="I CAN MAKE THIS WORK Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-51754530-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="icon" href="/img/favicon/profile.jpg">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/favicon/apple-touch-icon.png"><title data-react-helmet="true">2 posts tagged with &quot;wkhtmltopdf&quot; | I CAN MAKE THIS WORK</title><meta data-react-helmet="true" property="og:title" content="2 posts tagged with &quot;wkhtmltopdf&quot; | I CAN MAKE THIS WORK"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" name="twitter:image" content="https://blog.johnnyreilly.com/img/profile.png"><meta data-react-helmet="true" property="og:url" content="https://blog.johnnyreilly.com/tags/wkhtmltopdf"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-react-helmet="true" name="robots" content="max-image-preview:large"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://blog.johnnyreilly.com/tags/wkhtmltopdf"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/tags/wkhtmltopdf" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://blog.johnnyreilly.com/tags/wkhtmltopdf" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ff16c2af.css">
<link rel="preload" href="/assets/js/runtime~main.2cfd3172.js" as="script">
<link rel="preload" href="/assets/js/main.14ca547e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/profile.jpg" alt="I CAN MAKE THIS WORK" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">I CAN MAKE THIS WORK</b></a><a class="navbar__item navbar__link" href="/about">About</a><a class="navbar__item navbar__link" href="/blog-archive">Blog Archive</a><a class="navbar__item navbar__link" href="/talks">Talks</a></div><div class="navbar__items navbar__items--right"><a href="https://polywork.johnnyreilly.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Polywork<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-tags-post-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/12/05/azure-static-web-app-deploy-previews-with-azure-devops">Azure Static Web App Deploy Previews with Azure DevOps</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/11/22/typescript-vs-jsdoc-javascript">TypeScript vs JSDoc JavaScript</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/11/18/azure-standard-tests-with-bicep">Azure standard availability tests with Bicep</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/10/31/nswag-generated-c-sharp-client-property-name-clash">NSwag generated C# client: Open API property name clashes and decimal types rather than double</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2021/10/18/docusaurus-meta-tags-and-google-discover">Docusaurus, meta tags and Google Discover</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>2 posts tagged with &quot;wkhtmltopdf&quot;</h1><a href="/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2013/01/03/html-to-pdf-using-wcf-service">HTML to PDF using a WCF Service</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2013-01-03T00:00:00.000Z" itemprop="datePublished">January 3, 2013</time> Â· <!-- -->4 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_31ik" id="tl-dr---talk-is-cheap-show-me-the-code">TL; DR - &quot;Talk is cheap. Show me the code.&quot;<a aria-hidden="true" class="hash-link" href="#tl-dr---talk-is-cheap-show-me-the-code" title="Direct link to heading">â€‹</a></h2><p>Some time ago I wrote a <a href="http://icanmakethiswork.blogspot.com/2012/04/making-pdfs-from-html-in-c-using.html" target="_blank" rel="noopener noreferrer">post which demonstrated how you could make PDFs from HTML</a> using C# and <a href="http://code.google.com/p/wkhtmltopdf/" target="_blank" rel="noopener noreferrer">wkhtmltopdf</a>. To my lasting surprise this has been the most popular post I&#x27;ve written. I recently put together an ASP.NET WCF service which exposed this functionality which I thought might be worth sharing. The code can be found on GitHub <a href="https://github.com/johnnyreilly/PdfMakerWcfService" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="a-little-more-detail">A little more detail<a aria-hidden="true" class="hash-link" href="#a-little-more-detail" title="Direct link to heading">â€‹</a></h2><p>I should say up front that I&#x27;m still a little ambivalent about how sensible an idea this is. Behind the scenes this WCF service is remotely firing up wkhtmltopdf using <code>System.Diagnostics.Process</code>. I feel a little wary about recommending this as a solution for a variety of not particularly defined reasons. However, I have to say I&#x27;ve found this pretty stable and reliable. Bottom line it seems to work and work consistently. But I though I should include a caveat emptor; there is probably a better approach than this available. Anyway...</p><p>There isn&#x27;t actually a great deal to say about this WCF service. It should (hopefully) just do what it says on the tin. Putting it together didn&#x27;t involve a great deal of work; essentially it takes the code from the initial blog post and just wraps it in a WCF service called <code>PdfMaker</code>. The service exposes 2 methods:</p><ol><li><code>GetPdf</code> <!-- -->-<!-- --> given a supplied URL this method creates a PDF and then returns it as a Stream to the client</li><li><code>GetPdfUrl</code> <!-- -->-<!-- --> given a supplied URL this method creates a PDF and then returns the location of it to the client</li></ol><p>Both of these methods also set a Location header in the response indicating the location of the created PDF.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="that-which-binds-us">That which binds us<a aria-hidden="true" class="hash-link" href="#that-which-binds-us" title="Direct link to heading">â€‹</a></h2><p>The service uses <code>webHttpBinding</code>. This is commonly employed when people want to expose a RESTful WCF service. The reason I&#x27;ve used this binding is I wanted a simple &quot;in&quot; when calling the service. I wanted to be able to call the service via AJAX as well as directly by browsing to the service and supplying a URL-encoded URL like this:</p><p><code>http://localhost:59002/PdfMaker.svc/GetPdf?url=http%3A%2F%2Fnews.ycombinator.com/</code>You may wonder why I&#x27;m using <a href="http://news.ycombinator.com" target="_blank" rel="noopener noreferrer">http://news.ycombinator.com</a> for the example above. I chose this as Hacker News is a very simple site; very few resources and a small page size. This means the service has less work to do when creating the PDF; it&#x27;s a quick demo.</p><p>I should say that this service is arguably <!-- -->*<!-- -->*<!-- -->not<!-- -->*<!-- -->*<!-- --> completely RESTful as each GET operation behind the scenes attempts to create a new PDF (arguably a side-effect). These should probably be POST operations as they create a new resource each time they&#x27;re hit. However, if they were I wouldn&#x27;t be able to just enter a URL into a browser for testing and that&#x27;s really useful. So tough, I shake my fist at the devotees of pure REST on this occasion. (If I should be attacked in the street shortly after this blog is posted then the police should be advised this is good line of inquiry...)</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="good-behaviour">Good behaviour<a aria-hidden="true" class="hash-link" href="#good-behaviour" title="Direct link to heading">â€‹</a></h2><p>It&#x27;s worth noting that <code>automaticFormatSelectionEnabled</code> set to true on the behaviour so that content negotiation is enabled. Obviously for the <code>GetPdf</code> action this is rather meaningless as it&#x27;s a stream that&#x27;s passed back. However, for the <code>GetPdfUrl</code> action the returned string can either be JSON or XML. The Fiddler screenshots below demonstrate this in action:</p><p><img src="https://4.bp.blogspot.com/-CX7w0jI0jTE/UOVaDP5Ae-I/AAAAAAAAAXk/H7zhyYYjPGA/s400/GetPdfUrl%2B-%2BJSON.png"></p><p><img src="https://4.bp.blogspot.com/-78GBDqI596I/UOVaTchTbBI/AAAAAAAAAXw/rz2Dg4g8BRs/s400/GetPdfUrl%2B-%2BXML.png"></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="test-harness">Test Harness<a aria-hidden="true" class="hash-link" href="#test-harness" title="Direct link to heading">â€‹</a></h2><p>As a final touch I added in a test harness in the form of <code>Demo.aspx</code>. If you browse to it you&#x27;ll see a screen a little like this:</p><p><img src="https://2.bp.blogspot.com/-zoyt7ufl9FQ/UOVmD0VPh0I/AAAAAAAAAYE/DnmZmbx-Mxc/s400/PdfMakerDemo.png"></p><p>It&#x27;s fairly self-explanatory as you can see. And here&#x27;s an example of the output generated when pointing at Hacker News:</p><iframe src="https://docs.google.com/file/d/0B87K8-qxOZGFMGNCUWRneUFsVFU/preview" width="500" height="500"></iframe><p>And that&#x27;s it. If there was a need this service could be easily extended to leverage the <a href="http://madalgo.au.dk/~jakobt/wkhtmltoxdoc/wkhtmltopdf-0.9.9-doc.html" target="_blank" rel="noopener noreferrer">various options</a> that wkhtmltopdf makes available. Hope people find it useful.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/wkhtmltopdf">wkhtmltopdf</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/html">html</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/wcf">WCF</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/pdf">pdf</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about HTML to PDF using a WCF Service" href="/2013/01/03/html-to-pdf-using-wcf-service"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_GeHD" itemprop="headline"><a itemprop="url" href="/2012/04/05/making-pdfs-from-html-in-c-using">Making PDFs from HTML in C# using WKHTMLtoPDF</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2012-04-05T00:00:00.000Z" itemprop="datePublished">April 5, 2012</time> Â· <!-- -->7 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://blog.johnnyreilly.com/img/profile.jpg" alt="John Reilly"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_31ik" id="update-03012013">Update 03/01/2013<a aria-hidden="true" class="hash-link" href="#update-03012013" title="Direct link to heading">â€‹</a></h2><p>I&#x27;ve written a subsequent post which builds on the work of this original post. The new post exposes this functionality via a WCF service and can be found <a href="http://icanmakethiswork.blogspot.co.uk/2013/01/html-to-pdf-using-wcf-service.html" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="making-pdfs-from-html">Making PDFs from HTML<a aria-hidden="true" class="hash-link" href="#making-pdfs-from-html" title="Direct link to heading">â€‹</a></h2><p>I wanted to talk about an approach I&#x27;ve discovered for making PDFs directly from HTML. I realise that in these wild and crazy days of <a href="http://mozilla.github.com/pdf.js/" target="_blank" rel="noopener noreferrer">PDF.js</a> and the like that techniques like this must seem very old hat. That said, this technique works and more importantly it solves a problem I was faced with but without forcing the users to move the &quot;newest hottest version of X&quot;. Much as many of would love to solve problems this way, alas many corporations move slower than that and in the meantime we still have to deliver - we still have to meet requirements. Rather than just say &quot;I did this&quot; I thought I&#x27;d record how I got to this point in the first place. I don&#x27;t know about you but I find the reasoning behind why different technical decisions get made quite an interesting topic...</p><p>For some time I&#x27;ve been developing / supporting an application which is used in an intranet environment where the company mandated browser is still IE 6. It was a requirement that there be &quot;print&quot; functionality in this application. As is well known (even by Microsoft themselves) the print functionality in IE 6 was never fantastic. But the requirement for usable printouts remained.</p><p>The developers working on the system before me decided to leverage Crystal Reports (remember that?). Essentially there was a reporting component to the application at the time which created custom reports using Crystal and rendered them to the user in the form of PDFs (which have been eminently printable for as long as I care to remember). One of the developers working on the system realised that it would be perfectly possible to create some &quot;reports&quot; within Crystal which were really &quot;print to PDF&quot; screens for the app.</p><p>It worked well and this solution stayed in place for a very long time. However, some years down the line the Crystal Reports was discarded as the reporting mechanism for the app. But we were unable to decommission Crystal entirely because we still needed it for printing.</p><p>I&#x27;d never really liked the Crystal solution for a number of reasons:</p><ol><li>We needed custom stored procs to drive the Crystal print screens which were near duplicates of the main app procs. This duplication of effort never felt right.</li><li>We had to switch IDEs whenever we were maintaining our print screens. And the Crystal IDE is not a joy to use.</li><li>Perhaps most importantly, for certain users we needed to hide bits of information from the print. The version of Crystal we were using did not make the dynamic customisation of our print screens a straightforward proposition. (In its defence we weren&#x27;t really using it for what it was designed for.) As a result the developers before me had ended up creating various versions of each print screen revealing different levels of information. As you can imagine, this meant that the effort involved in making changes to the print screens had increased exponentially</li></ol><p>It occurred to me that it would be good if we could find some way of generating our own PDF reports without using Crystal that would be a step forward. It was shortly after this that I happened upon <a href="http://code.google.com/p/wkhtmltopdf/" target="_blank" rel="noopener noreferrer">WKHTMLtoPDF</a>. This is an open source project which describes itself as a <em>&quot;Simple shell utility to convert html to pdf using the webkit rendering engine, and qt.&quot;</em> I tested it out on various websites and it worked. It wasn&#x27;t by any stretch of the imagination a perfect HTML to PDF tool but the quality it produced greatly outstripped the presentation currently in place via Crystal.</p><p>This was just the ticket. Using WKHTMLtoPDF I could have simple web pages in the application which could be piped into WKHTMLtoPDF to make a PDF as needed. It could be dynamic - because ASP.NET is dynamic. We wouldn&#x27;t need to write and maintain custom stored procs anymore. And happily we would no longer need to use Crystal.</p><p>Before we could rid ourselves of Crystal though, I needed a way that I could generate these PDFs on the fly within the website. For this I ended up writing a simple wrapper class for WKHTMLtoPDF which could be used to invoke it on the fly. In fact a good portion of this was derived from various contributions on <a href="http://stackoverflow.com/q/1331926" target="_blank" rel="noopener noreferrer">a post on StackOverflow</a>. It ended up looking like this:</p><script src="https://gist.github.com/2341776.js?file=PdfGenerator.cs"></script><p>With this wrapper I could pass in URLs and extract out PDFs. Here&#x27;s a couple of examples of me doing just that:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cs"><pre tabindex="0" class="prism-code language-cs codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">//Create PDF from a single URL</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    var pdfUrl = PdfGenerator.HtmlToPdf(pdfOutputLocation: &quot;~/PDFs/&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        outputFilenamePrefix: &quot;GeneratedPDF&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        urls: new string[] { &quot;http://news.bbc.co.uk&quot; });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //Create PDF from multiple URLs</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    var pdfUrl = PdfGenerator.HtmlToPdf(pdfOutputLocation: &quot;~/PDFs/&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        outputFilenamePrefix: &quot;GeneratedPDF&quot;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        urls: new string[] { &quot;http://www.google.co.uk&quot;, &quot;http://news.bbc.co.uk&quot; });</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>As you can see from the second example above it&#x27;s possible to pipe a number of URLs into the wrapper all to be rendered to a single PDF. Most of the time this was surplus to our requirements but it&#x27;s good to know it&#x27;s possible. Take a look at the BBC website PDF generated by the first example:</p><iframe src="https://docs.google.com/file/d/0B87K8-qxOZGFYktEWGtXRXJSSS1ZWFR4emFfMmVxZw/preview" width="500" height="500"></iframe><p>Pretty good, no? As you can see it&#x27;s not perfect from looking at the titles (bit squashed) but I deliberately picked a more complicated page to show what WKHTMLtoPDF was capable of. The print screens I had in mind to build would be significantly simpler than this.</p><p>Once this was in place I was able to scrap the Crystal solution. It was replaced with a couple of &quot;print to PDF&quot; ASPXs in the main web app which would be customised when rendering to hide the relevant bits of data from the user. These ASPXs would be piped into the HtmlToPdf method as needed and then the user would be redirected to that PDF. If for some reason the PDF failed to render the users would see the straight &quot;print to PDF&quot; ASPX - just not as a PDF if you see what I mean. I should say that it was pretty rare for a PDF to not render but this was my failsafe.</p><p>This new solution had a number of upsides from our perspective:</p><ul><li>Development maintenance time (and consequently cost for our customers) for print screens was significantly reduced. This was due to the print screens being part of the main web app. This meant they shared styling etc with all the other web screens and the dynamic nature of ASP.NET made customising a screen on the fly simplicity itself.</li><li>We were now able to regionalise our print screens for the users in the same way as we did with our main web app. This just wasn&#x27;t realistic with the Crystal solution because of the amount of work involved.</li><li>I guess this is kind of a <a href="http://en.wikipedia.org/wiki/Don%27t_repeat_yourself" target="_blank" rel="noopener noreferrer">DRY</a> solution :-)</li></ul><p>You can easily make use of the above approach yourself. All you need do is download and install <a href="http://code.google.com/p/wkhtmltopdf/" target="_blank" rel="noopener noreferrer">WKHTMLtoPDF</a> on your machine. I advise using version 0.9.9 as the later release candidates appear slightly buggy at present.</p><p>Couple of gotchas:</p><ol><li>Make sure that you pass the correct installation path to the HtmlToPdf method if you installed it anywhere other than the default location. You&#x27;ll see that the class assumes the default if it wasn&#x27;t passed</li><li>Ensure that Read and Execute rights are granted to the wkhtmltopdf folder for the relevant process</li><li>Ensure that Write rights are granted for the location you want to create your PDFs for the relevant process</li></ol><p>In our situation we are are invoking this directly in our web application on demand. I have no idea how this would scale - perhaps not well. This is not really an issue for us as our user base is fairly small and this functionality isn&#x27;t called excessively. I think if this was used much more than it is I&#x27;d be tempted to hive off this functionality into a separate app. But this works just dandy for now.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/wkhtmltopdf">wkhtmltopdf</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/webkit">webkit</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/c">c#</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/html">html</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/pdf">pdf</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Making PDFs from HTML in C# using WKHTMLtoPDF" href="/2012/04/05/making-pdfs-from-html-in-c-using"><b>Read More</b></a></div></footer></article></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items"><li class="footer__item"><a href="https://www.buymeacoffee.com/qUBm0Wh" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;"></a></li><li class="footer__item"><div style="display: flex; align-items: center;"><iframe src="https://github.com/sponsors/johnnyreilly/button" title="Sponsor johnnyreilly" height="35" width="116" style="border: 0;"></iframe><div>&nbsp;on GitHub</div></div></li></ul></div><div class="col footer__col"><div class="footer__title">Feeds</div><ul class="footer__items"><li class="footer__item"><a href="https://blog.johnnyreilly.com/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://blog.johnnyreilly.com/atom.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Atom<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2cfd3172.js"></script>
<script src="/assets/js/main.14ca547e.js"></script>
</body>
</html>